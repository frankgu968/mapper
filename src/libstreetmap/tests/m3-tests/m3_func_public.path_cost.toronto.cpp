#include <random>
#include <unittest++/UnitTest++.h>
#include "StreetsDatabaseAPI.h"
#include "mapProcessor.h"
#include "m3.h"

#include "unit_test_util.h"
#include "path_verify.h"

using ece297test::relative_error;
using ece297test::path_is_legal;
struct MapFixture {
    MapFixture() {
        rng = std::minstd_rand(0);
        rand_intersection = std::uniform_int_distribution<unsigned>(0, getNumberOfIntersections()-1);
        rand_street = std::uniform_int_distribution<unsigned>(1, getNumberOfStreets()-1);
        rand_segment = std::uniform_int_distribution<unsigned>(0, getNumberOfStreetSegments()-1);
        rand_poi = std::uniform_int_distribution<unsigned>(0, getNumberOfPointsOfInterest()-1);
        rand_lat = std::uniform_real_distribution<float>(43.48, 43.91998);
        rand_lon = std::uniform_real_distribution<float>(-79.78998, -79.00001);
    }

    std::minstd_rand rng;
    std::uniform_int_distribution<unsigned> rand_intersection;
    std::uniform_int_distribution<unsigned> rand_street;
    std::uniform_int_distribution<unsigned> rand_segment;
    std::uniform_int_distribution<unsigned> rand_poi;
    std::uniform_real_distribution<float> rand_lat;
    std::uniform_real_distribution<float> rand_lon;
};

SUITE(path_cost_public) {
    TEST(street_segment_length) {
        double expected;
        double actual;
        
        expected = 7.409452272906631;
        actual = find_street_segment_length(143141);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 12.15066338145396;
        actual = find_street_segment_length(142302);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 13.16748662475364;
        actual = find_street_segment_length(135429);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 14.54978066852702;
        actual = find_street_segment_length(152574);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 17.8627354732516;
        actual = find_street_segment_length(117359);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 26.68528981096977;
        actual = find_street_segment_length(138372);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 32.58001876826201;
        actual = find_street_segment_length(157069);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 37.24807891141139;
        actual = find_street_segment_length(140736);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 42.95039055162051;
        actual = find_street_segment_length(14134);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 43.59326776211613;
        actual = find_street_segment_length(141981);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 45.75931725992191;
        actual = find_street_segment_length(46896);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 51.32059732689547;
        actual = find_street_segment_length(151773);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 61.02074141488161;
        actual = find_street_segment_length(62823);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 66.5944026729866;
        actual = find_street_segment_length(103072);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 90.1740097590217;
        actual = find_street_segment_length(94920);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 91.56385641955104;
        actual = find_street_segment_length(81286);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 93.20682834182405;
        actual = find_street_segment_length(114629);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 105.756403651549;
        actual = find_street_segment_length(80771);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 127.6393014257723;
        actual = find_street_segment_length(46410);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 165.8409328695615;
        actual = find_street_segment_length(152787);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 173.2163218916415;
        actual = find_street_segment_length(13421);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 194.1213129345265;
        actual = find_street_segment_length(91902);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 219.1726428117;
        actual = find_street_segment_length(41498);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 241.6458170730914;
        actual = find_street_segment_length(29941);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 269.7374202783854;
        actual = find_street_segment_length(25999);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 271.9466190991451;
        actual = find_street_segment_length(88454);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 320.8068185741665;
        actual = find_street_segment_length(93431);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 330.3221082391712;
        actual = find_street_segment_length(67250);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 381.2119396584995;
        actual = find_street_segment_length(127786);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 674.8669607293826;
        actual = find_street_segment_length(3);
        CHECK(relative_error(expected, actual) < 0.001);
        
    } //street_segment_length

    TEST(compute_path_travel_time) {
        std::vector<unsigned> path;
        double expected;
        double actual;
        
        path = {};
        expected = 0;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {132247, 5602, 137681, 267, 268, 28748, 137685, 137686, 28746, 28747, 19512, 19513, 19518, 14414, 14415, 19523, 3172, 155030, 9612, 9613, 9614, 9615, 32896, 32915, 32897, 32898, 32899, 32900, 32901, 32902, 32903, 10654, 10655, 10656, 10657, 10658, 10659, 10660, 10661, 10662, 10663, 10664, 10665, 10666, 2923, 2924, 2925, 2926, 2927, 2928, 2929, 2930, 2931, 2932, 2933, 2934, 2935, 120624, 120625, 120626, 120627, 120628, 120629, 120630, 134592, 146657, 146641};
        expected = 8.366029571574483;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {131421, 131420, 131419, 131434, 131435, 131436, 131484, 131469, 131474, 131485, 131480, 131479, 131512, 131509, 132133, 132117, 132121, 5610, 132123, 5605, 5606, 132244, 132235, 132233, 132248, 132241, 132247, 132243, 137248, 132300, 132302, 137247, 157004, 3638, 3637, 156465, 3636, 192, 137774, 143874, 143873, 143872, 19422, 18898};
        expected = 8.524574320215475;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {148083, 148080, 96784, 96768, 96752, 96795, 96772, 156627, 74299, 49499, 156586, 52508, 50826, 74294, 49978, 74291, 74290, 74287, 124674, 124675, 36194, 36195, 36196, 36197, 139315, 139316, 139317, 156713, 121053, 121054, 121055, 121056, 141636, 134273, 121057, 113329, 36212, 156371, 156373, 156895, 156896, 36214, 36215, 125702, 125703, 125701, 113330, 7815, 35407, 36224, 36226, 36227, 36230, 7821, 7822, 147045, 147047, 36234, 36235, 128627, 128628, 146965, 69623, 69624, 146960, 146961, 146962, 69625, 69626, 69627, 69628, 69629, 69630, 69631, 69632, 69633, 69634, 69635, 19924};
        expected = 11.24158306911421;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {23584, 23583, 23582, 23581, 23580, 23579, 23578, 23577, 23576, 23575, 23574, 23573, 23572, 23571, 23570, 23569, 23568, 23567, 23566, 23565, 106803, 106804, 106805, 106806, 87385, 87386, 87387, 87388, 87389, 87390, 87391, 87392, 87393, 133274, 133275, 133276, 133277, 133278, 133251, 133252, 133253, 23486, 23487, 23488, 23489, 118219, 118220, 118223, 118224, 118225, 118226, 114814, 114813, 114812, 114811, 114810, 114809, 114808, 114807, 25199, 25200, 56076, 56075, 56074, 56073, 24439, 77223, 77210, 77219, 77220, 113238, 113240, 113239, 77209, 77208, 77201, 46415, 46414, 46413, 46412, 77197, 77196, 77195, 77183, 77190, 77192, 77182, 77181, 77180, 77179, 77157, 77162, 77169, 77165, 10909, 10908, 10907, 10906, 10903, 156705, 156706, 113505, 156621, 114670, 10924, 10918, 10919, 10920, 154200, 154201, 154204, 77101, 77100, 77099, 77098, 77097, 77096, 77095, 77094, 77093, 77092, 77091, 77090, 77089, 77088, 77087, 77086, 77085, 77083, 77081, 77082, 114815, 28979, 28980, 28981, 28982, 28983, 28984, 28985, 28986, 28987, 28988, 28989, 28990, 28991, 28992, 28993, 28994, 65247, 65258, 65245, 65187, 65222, 65232, 65239, 65225, 107640, 107639, 107638};
        expected = 14.41193740511257;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {133410, 4614, 80239, 80240, 80249, 80241, 80242, 80251, 146330, 80237, 80245, 80252, 80253, 80243, 140482, 140481, 140480, 140479, 140478, 140477, 140474, 140473, 140476, 140475, 28647, 28646, 131233, 131232, 131231, 131230, 131234, 59473, 59472, 59471, 59470, 59459, 59468, 59462, 139941, 139940, 139939, 155077, 14206, 14207, 56233, 56232, 56231, 56230, 56229, 56228, 56227, 56226, 56225, 56224, 56223, 56222, 56209, 56214, 56219, 152251, 152252, 154242, 1063, 56234, 111793, 125163, 6344, 111789, 111790, 111791, 61817, 61818, 14185, 14186, 14187, 14216, 14214, 14215, 62310, 62311, 62312, 62288, 62289, 113997, 113998, 647, 648, 83714, 83715, 138596, 113980, 126639, 153410, 14296, 14295, 153407, 153408, 139845, 2514, 139284, 2513, 12686, 12689, 12690, 12691, 20365, 20363, 20364, 86784, 86785, 57803, 155722, 155718, 155719, 155720, 155583, 155584, 155585, 84056, 57802, 57801, 57215, 57214, 29049, 29050, 29048, 57212, 153325, 57211, 57239, 57238, 57237, 57230, 57233, 57234, 62932, 143001, 143002, 62974, 31763};
        expected = 16.81397859808713;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {16196, 8273, 103386, 16, 111782, 111784, 143246, 125165, 16199, 1062, 14, 111787, 111788, 103384, 16194, 16193, 8272, 124052, 124053, 124054, 645, 123655, 9538, 9539, 39239, 39240, 39241, 39242, 39243, 143259, 39223, 39224, 39225, 140559, 129208, 82202, 82203, 82196, 82195, 82194, 101365, 82180, 140550, 140553, 140555, 140552, 9217, 28831, 111927, 28829, 28830, 111933, 107649, 149114, 124118, 124119, 124120, 124121, 124122, 86619, 86620, 86621, 86622, 103238, 103230, 103231, 103232, 103233, 103234, 103235, 103236, 103237, 86638, 86639, 86640, 86641, 86642, 86643, 86644, 86645, 86646, 84529, 84517, 84518, 84519, 84520, 84521, 84522, 84523, 84524, 132288, 132289, 132290, 132291, 132283, 132274, 132275, 132276, 132277, 132278, 132279, 132280, 132281, 132282, 114920, 114921, 114922, 114923, 114924, 114925, 114926, 114927, 114928, 114929, 114930, 114931, 116315, 116316, 116317, 116318, 116319, 116320, 116321, 8373, 8374, 8375};
        expected = 16.95411743870452;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {75478, 75479, 75480, 75481, 75482, 75483, 75484, 75485, 75496, 76413, 76414, 76415, 76416, 99361, 99362, 120805, 120810, 120811, 120812, 120804, 120798, 120801, 120802, 120803, 153477, 97900, 97901, 97849, 98044, 97889, 97861, 97893, 97894, 97895, 97896, 97897, 154969, 154970, 154971, 154972, 154968, 26714, 26715, 26716, 26717, 26718, 55947, 55946, 26712, 26719, 26713, 115052, 115053, 115054, 115055, 115056, 115057, 115058, 115059, 115060, 115061, 115062, 115063, 115064, 115065, 115066, 115067, 115068, 115069, 115070, 115071, 115072, 115073, 115074, 115075, 115076, 115077, 135936, 30195, 30196, 11384, 129030, 129031, 129021, 30020, 30021, 30039, 30040, 480, 30380, 30381, 30382, 123982, 123983, 115439, 115438, 26046, 482, 115287, 123973, 29232, 27123, 115284, 120671, 120672, 120690};
        expected = 18.5200946435247;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {17165, 17166, 108101, 108095, 108096, 86113, 86114, 86123, 86126, 86127, 86109, 147456, 137307, 103107, 103108, 1067, 136875, 118034, 118037, 118036, 135, 136, 111863, 111864, 13, 46502, 86365, 139, 140, 117906, 94540, 503, 131267, 131272, 131273, 28358, 28359, 501, 111859, 131279, 131281, 116051, 116052, 116053, 116054, 116055, 131423, 131418, 131419, 131434, 131435, 131436, 131484, 131469, 131474, 131485, 131480, 131479, 131512, 131509, 132119, 132126, 132132, 132120, 132118, 132124, 132125, 136392, 136393, 9978, 9977, 16506, 120015, 20346, 20347, 62435, 62436, 155457, 62442, 154441, 154442, 154443, 154444, 154445, 154446, 123205, 123204, 123203, 140946};
        expected = 18.58283319932795;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {129986, 129988, 129989, 62988, 62989, 63045, 62990, 63176, 63183, 63090, 63138, 63115, 65045, 65050, 65051, 65052, 65044, 65046, 65047, 65048, 65049, 65053, 45971, 45970, 45969, 45968, 45967, 45966, 45965, 45964, 45963, 44547, 44548, 145561, 45272, 30308, 64967, 64799, 64805, 64792, 64867, 64868, 64800, 64801, 64802, 64854, 64970, 64971, 64972, 64606, 64605, 64586, 64589, 64060, 64119, 64118, 64531, 64027, 64064, 63894, 63903, 63896, 63904, 63890, 63911, 63881, 63880, 63879, 63893, 63902, 154929, 63882, 154928, 63901, 63900, 63899, 63898, 63897, 63872, 63873, 63891, 63884, 63892, 63889, 63885, 63912, 63242, 63198, 63377, 63241, 63218, 63219, 63321, 63353, 63352, 63245, 63216, 63314, 63395, 63320, 63236, 63316, 63413, 63254, 63222, 63387, 63264, 63332, 63372, 63334, 63285, 63368, 63234, 63243, 63411, 63223, 63230, 101301, 101300, 101299, 101298, 101297, 53573, 53572, 53571, 53570, 87311, 87310, 87309, 87308, 138566, 138562, 138559, 138560, 138568, 138565, 3233, 3232, 3231, 136809, 136808, 136807, 136806, 136805, 136804, 136803, 136802, 136801, 136800, 136799, 136798, 136797, 136796, 156322, 156289, 156237, 156238, 156239, 156240};
        expected = 18.88936321980889;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {131888, 131887, 131886, 131893, 117683, 117686, 131858, 131859, 131860, 131861, 131862, 131863, 131864, 131865, 131866, 131867, 131868, 131869, 131870, 131871, 132005, 132004, 132003, 132002, 132001, 132000, 131999, 155281, 53349, 131854, 139887, 155321, 155320, 155311, 131853, 134237, 62298, 14229, 113977, 113978, 62281, 62282, 62283, 62304, 62305, 14220, 14221, 14222, 14223, 14192, 14193, 61811, 61812, 111804, 111803, 111798, 111785, 111786, 111787, 111788, 103384, 16194, 16193, 8272, 124052, 124053, 124054, 645, 123655, 9538, 9539, 39239, 39240, 39241, 39242, 39243, 143259, 39223, 39224, 39225, 140559, 129208, 82202, 82203, 82196, 82195, 82194, 101365, 82180, 140550, 140553, 140555, 140552, 9217, 28831, 111927, 28829, 28830, 111933, 107649, 149114, 124118, 124119, 124120, 124121, 124122, 86619, 86620, 86621, 86622, 103238, 103230, 103231, 103232, 103233, 103234, 103235, 103236, 103237, 86638, 86639, 86640, 86641, 86642, 86643, 86644, 86645, 86646, 84529, 84517, 84518, 84519, 84520, 84521, 84522, 84523, 84524, 132288, 132289, 132290, 132291, 132283, 132274, 132275, 132276, 132277, 132278, 132279, 132280, 132281, 132282, 114920, 114921, 114922, 114923, 114924, 114925, 114926, 114927, 114928, 114929, 114930, 114931, 110733, 110734, 149131, 149130, 110735, 137230, 146094, 110736, 137244, 84701, 84703, 123361};
        expected = 19.07517158836748;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {135900, 39835, 8910, 27703, 84347, 82823, 82767, 144428, 82766, 82778, 82777, 110694, 110693, 110692, 110688, 110687, 110689, 84683, 148953, 27701, 27702, 151515, 53855, 53856, 123363, 123362, 123361, 84703, 84701, 137242, 137245, 137246, 137231, 137232, 137233, 137234, 137235, 137236, 137237, 137238, 137239, 137240, 84671, 120824, 84102, 116957, 84100, 84101, 84090, 84091, 84092, 84093, 84094, 84095, 84096, 84097, 84098, 116958, 116959, 116960, 116961, 116962, 116963, 137468, 86074, 86075, 86076, 86077, 86078, 86079, 86080, 86081, 86082, 86083, 86084, 86085, 86086, 86087, 86088, 86089, 86090, 86091, 86092, 86093, 86094, 35084, 35085, 136469, 16786, 136470, 136471, 136472, 136473, 136474, 16782, 16783, 16784, 16785, 136468, 86974, 86975, 16464, 136467, 16461, 16462, 16463, 16460, 128528, 128530, 128531, 36647, 36648, 132499, 132500, 132501, 16465, 16466, 16467, 16468, 16469, 16470, 67770, 136457, 67771, 67767, 67779, 30274, 12286, 5651, 108200, 108202, 108203, 139155, 139153, 127910, 30272, 30273, 65350, 65343, 65351, 65355, 65356, 65357, 65333, 65329, 65324, 65341, 65342, 5663, 123965, 123966, 123967, 21142, 21143, 123948, 114789, 123949, 29098, 133885, 114794, 29099, 29100, 114647, 114648, 146371, 133880, 29097, 123972, 69036, 69037, 69038, 88246, 88245};
        expected = 19.99394200185969;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {72733, 72741, 72728, 123701, 123711, 123709, 123710, 96770, 96750, 96775, 96780, 96745, 123697, 96796, 96778, 117860, 9551, 117854, 117855, 117918, 117919, 117929, 117920, 117921, 117914, 117926, 117927, 117928, 136870, 136873, 118035, 136872, 118047, 118040, 118041, 118042, 136874, 136875, 118034, 118037, 137, 138, 124, 111862, 46501, 125, 126, 8273, 103386, 111779, 111780, 646, 111789, 111790, 111791, 61817, 61818, 14185, 14186, 2630, 111805, 138418, 137830, 53364, 111161, 82106, 82121, 82133, 82101, 82125, 82129, 82139, 59221, 59222, 59219, 59223, 124619, 124620, 124621, 59189, 59190, 59188, 59224, 59225, 59200, 59196, 59226, 59194, 59195, 59227, 157144, 53020, 49408, 82071, 82072, 82073, 82075, 82070, 82065, 129239, 113084, 113080, 113079, 113078, 113077};
        expected = 20.01379098565064;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {57931, 57923, 58002, 57972, 155441, 155440, 155439, 1061, 1060, 1059, 59661, 59655, 143300, 143301, 143302, 59659, 59654, 59652, 59657, 59651, 59656, 59660, 59658, 144427, 59712, 59710, 59714, 59717, 59831, 59792, 59793, 59794, 59803, 59825, 59808, 59809, 59810, 59812, 59813, 59880, 59876, 59879, 4139, 129075, 19321, 19322, 62344, 62345, 62346, 62347, 121066, 121069, 121068, 113373, 117895, 18873, 18872, 138312, 128464, 140340, 140341, 140342, 88131, 88130, 127268, 127269, 127270, 36218, 36219, 112478, 88321, 139379, 7818, 7819, 150752, 112481, 126875, 85139, 85132, 124042, 143351, 36243, 36252, 36253, 147041, 36238, 36239, 147040, 147042, 121913, 121914, 134617, 134618, 134619, 150396, 150397, 150398, 150631, 150633, 150616, 150617, 150618, 150619, 150620, 150621, 150622, 150623, 150624, 150625, 150626, 150627, 150628, 150629, 152410, 152411, 22951, 22952, 99647, 106172, 106177};
        expected = 21.84656884122483;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {133917, 20471, 20470, 20469, 20468, 20467, 20466, 20465, 20464, 20463, 20462, 20461, 20460, 20459, 20458, 20457, 131091, 131092, 137148, 137149, 137150, 137151, 66453, 23465, 111938, 111940, 23453, 23454, 127735, 127736, 127734, 644, 101355, 23484, 23485, 101358, 101359, 101360, 28468, 28469, 28478, 28472, 111962, 84433, 84424, 111963, 111968, 111969, 12330, 84442, 84443, 111984, 111985, 5737, 13590, 13597, 13600, 13598, 13599, 5735, 5736, 5660, 5725, 5724, 5726, 5727, 5707, 5706, 5699, 123959, 484, 485, 486, 125021, 125022, 10888, 10894, 29650, 29651, 22633, 22629, 8113, 22608, 22609, 22573, 22574, 22584, 22583, 1439, 112795, 28715, 28716, 124999, 114606, 47191, 47192, 125002, 125003, 22781, 22782, 22783, 125006, 102591, 102589, 33815, 126895, 33838, 33839, 33840, 33841, 33842, 33843, 33844, 33845, 33846, 33847, 33848, 33849, 100226, 100194, 23090, 100213, 100214, 155645, 155644, 30841, 155632};
        expected = 25.28047709306835;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {53318, 51179, 19919, 19918, 19917, 19916, 51065, 48898, 122300, 128064, 128063, 150349, 150350, 150351, 6293, 125950, 125948, 125949, 80358, 80361, 80365, 152324, 35290, 154226, 128466, 154223, 154213, 154218, 154211, 154210, 92432, 92433, 143493, 92434, 92356, 92353, 92337, 92404, 92417, 92389, 92360, 92366, 92352, 92321, 92322, 92403, 92380, 92373, 92359, 92402, 92325, 92422, 92421, 92420, 92262, 92299, 92287, 92254, 92255, 92256, 92257, 45695, 146944, 146953, 146947, 146943, 146948, 146949, 45703, 45704, 45701, 45702, 45696, 45697, 45698, 111778, 92932, 150433, 92931, 92957, 92948, 92949, 92950, 92951, 92952, 92953, 92954, 92955, 145363, 145364, 145365, 145366, 145367, 145368, 145369, 145370, 145371, 137154, 137156, 137159, 137157, 137153, 109757, 109756, 45780, 45781, 45782, 45783, 45784, 45785, 45786, 129931, 129932, 129922, 129923, 140859, 140860, 140862, 94192, 135633, 87306, 87305, 87304, 87303, 87302, 87301, 87300, 87299, 87298, 149179, 149178, 149173, 149177, 149176, 149175, 149174, 119572, 155835, 155834, 155833, 155832, 155831, 155830, 155603, 155602, 155601, 119573, 12439, 109705, 109706, 109707, 109708, 82449, 127584, 47023, 47022, 47021, 47020, 47019, 47018, 47017, 47016, 47015, 47014};
        expected = 27.49354405703248;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {74305, 74306, 96800, 129829, 129830, 129831, 129832, 129833, 129834, 74314, 74315, 123737, 124670, 74324, 74323, 74321, 74322, 18848, 18849, 18852, 18853, 124676, 124677, 122666, 122667, 122668, 122669, 122652, 122653, 122651, 122654, 122655, 122656, 122657, 122658, 122659, 122660, 122661, 122662, 122663, 122619, 122620, 122618, 122621, 122622, 122623, 125642, 125641, 36183, 36184, 36185, 139678, 122752, 155263, 36154, 122860, 122861, 122862, 155204, 155205, 119801, 106119, 106121, 106122, 106116, 106123, 106127, 106117, 26477, 121070, 121067, 62349, 62350, 19323, 19324, 129068, 129069, 129070, 129071, 129072, 129073, 129040, 129041, 26863, 26864, 129140, 129142, 129143, 125336, 125335, 125339, 138504, 138505, 26847, 26848, 135828, 19327, 19328, 88327, 88328, 125311, 103415, 103416, 103417, 125613, 103419, 125611, 88267, 88268, 88264, 88265, 88266, 129060, 117033, 117034, 108376, 126553, 126554, 127264, 127260, 127261, 71683, 71686, 71679, 71688, 71689, 71690, 71691, 103637, 103638, 103639, 103640, 103641, 103642, 103643, 103644, 103645, 103646, 103647, 103648, 103649, 97646, 97644, 97645, 103855, 103856, 103882, 103901, 103876, 103890};
        expected = 28.11627867368049;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {108902, 108895, 108904, 79250, 79249, 79248, 79247, 79246, 68119, 68108, 68123, 68109, 68110, 68130, 68126, 68131, 143131, 143137, 143138, 134205, 134206, 134207, 134208, 134209, 134200, 134201, 134202, 134203, 134204, 68055, 68058, 68100, 68049, 68051, 68052, 68095, 68096, 68097, 68098, 68059, 68048, 68085, 68086, 68087, 68088, 68089, 68090, 68091, 68092, 68093, 68094, 112854, 112857, 112856, 112855, 68067, 68064, 68054, 68068, 68069, 68070, 68071, 68072, 68073, 149147, 149148, 149149, 149150, 149151, 149152, 86676, 149153, 86674, 86675, 84227, 84226, 86509, 86510, 86511, 86512, 86513, 86514, 86515, 62635, 62636, 62639, 62655, 62656, 62657, 62658, 62659, 62660, 62661, 62662, 62663, 62664, 149112, 149110, 149111, 86668, 86669, 86670, 86671, 149566, 149567, 86667, 82627, 82628, 86666, 152314, 152315, 152316, 152317, 152318, 436, 124122, 124121, 124120, 124119, 124118, 124117, 124116, 124111, 124115, 124114, 124113, 124112, 66482, 66481, 66480, 66479, 66478, 66477, 66459, 66463, 66476, 66474, 66475, 66458, 66470, 66472, 66473, 66438, 66437, 66435, 66433, 66434, 66444, 66442, 66441, 66443, 66447, 66451, 66453, 23465, 111938, 111940, 23453, 23454, 127735, 127736, 127734, 644, 101355, 23484, 23485, 101358, 101359, 101360, 28468, 28469, 28478, 28472, 111962, 84433, 84424, 111963, 111968, 111969, 12330, 84442, 84443, 111984, 111985, 5737, 13590, 13597, 13600, 13598, 13599, 123962, 5738, 636, 637, 123951, 639, 640, 115443, 115440, 86129, 641, 123984, 30386, 30385, 30034, 30035, 116903, 116898, 116902, 113537, 113536, 11385, 154119, 154118, 153794, 30188, 129025, 30189, 30190, 30191, 30192, 30193, 115076, 115075, 115074, 115073, 115072, 115071, 115070, 115069, 115068, 115067, 115066, 115065, 34269, 34270, 34193, 34234};
        expected = 31.19053014412676;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {97321, 14273, 14272, 154938, 136189, 12663, 12664, 155649, 155650, 155648, 84507, 84506, 84505, 84504, 84503, 84502, 32162, 77224, 77225, 77226, 77227, 77228, 97335, 97336, 97337, 97338, 97339, 97340, 35406, 66716, 66717, 66715, 66718, 66722, 36382, 36383, 36384, 36385, 36386, 36387, 36388, 66689, 155660, 66697, 66691, 66688, 66712, 66713, 66714, 156926, 22089, 22090, 138461, 138464, 138465, 138466, 138467, 3801, 136780, 136783, 83747, 83748, 28589, 28590, 111990, 111991, 12352, 2987, 111983, 84446, 84447, 111982, 111978, 111964, 111967, 84430, 84426, 111965, 111966, 28470, 28471, 111961, 28460, 28461, 28455, 28456, 146249, 146250, 101356, 111945, 23478, 23479, 111947, 111946, 6323, 127732, 127733, 111954, 111955, 23459, 23460, 111939, 101357, 114902, 9263, 111924, 111923, 111925, 101376, 111926, 28823, 28824, 28836, 28837, 6339, 6340, 140551, 140556, 140554, 82181, 140549, 82185, 82186, 82187, 82208, 82209, 113975, 113976, 39231, 39232, 39233, 39234, 39235, 153429, 153430, 39246, 16184, 9544, 9545, 9546, 123654, 0, 1, 16196, 8273, 103386, 111779, 111780, 646, 111789, 111790, 111791, 61817, 61818, 14185, 14186, 2630, 111805, 138419, 14210, 14211, 14212, 2625, 155825, 124123, 124124, 124125, 111229, 142071, 142072, 142073, 142074, 142075, 61796, 61802, 61797, 61807, 61808, 61809, 155485, 155484, 84121, 84122, 84123, 84124, 84125, 84126, 84127, 61822, 61820, 61823, 61824, 61825, 61826, 61827, 61828, 116168, 116165, 116182, 116181, 116180, 148731, 116198, 116199, 116173, 140716, 116194, 116195, 116196, 116197, 132159, 147690, 147702};
        expected = 32.5849046198937;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {140917, 152754, 152755, 152756, 83696, 83697, 83698, 83699, 83700, 14157, 14158, 14159, 35992, 35993, 35988, 35989, 14160, 153574, 69553, 69552, 3966, 136712, 136711, 126628, 83723, 6101, 136438, 4, 5, 113977, 113978, 62281, 62282, 62283, 62304, 62305, 14220, 14221, 14222, 14223, 14192, 14193, 61811, 61812, 111804, 111803, 111798, 111785, 111786, 111787, 111788, 9, 11, 16191, 16192, 6342, 118033, 146, 12, 46504, 86365, 139, 140, 117906, 94540, 503, 131267, 131272, 131273, 28358, 28359, 501, 111859, 131279, 131281, 116051, 116052, 116053, 116054, 116055, 131423, 131418, 131419, 131434, 131435, 131436, 131484, 131469, 131474, 131485, 131480, 131479, 131512, 131509, 132119, 132126, 132132, 132120, 132118, 132124, 132125, 136390, 136391, 16765, 107218, 107219, 107221, 107217, 107220, 32309, 111851, 111852, 151926, 766, 119648, 119649, 40150, 585, 9533, 9532, 68481, 68482, 68483, 68484, 12238, 12235, 19244, 19245, 19246, 19263, 19264, 19251, 19252, 14026, 14027, 19268, 19269, 584, 68491, 68492, 111818, 111819, 582, 5094, 5101, 152113, 152114, 5097, 5098, 5099, 5110, 5111, 65623, 65624, 68632, 68617, 152548, 68618, 88718, 47421, 47422, 47412};
        expected = 33.25358760235393;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {28049, 28050, 28051, 110303, 110302, 110301, 146622, 146623, 146624, 146620, 146621, 146615, 146616, 146617, 146618, 146619, 150826, 150828, 150829, 150830, 146397, 146398, 146399, 146400, 146401, 146402, 146403, 146404, 146405, 114715, 110353, 110363, 110367, 110358, 110360, 110350, 110352, 110338, 110341, 110342, 110351, 119938, 119939, 110337, 110343, 110344, 89807, 89808, 89804, 89810, 89813, 89817, 89814, 137218, 137196, 137197, 137198, 137199, 137200, 137216, 137217, 138021, 138022, 138023, 138024, 138025, 137310, 137309, 48336, 14264, 14263, 14260, 82856, 82855, 88449, 88450, 82857, 82858, 112759, 112760, 102656, 82834, 82835, 36332, 36333, 91548, 91549, 12437, 12438, 82859, 82860, 82861, 82862, 82863, 82864, 101373, 3260, 3259, 102662, 128461, 128462, 126082, 126079, 126080, 126081, 126873, 126874, 24503, 24504, 24523, 24524, 24525, 24526, 24527, 24528, 24529, 24530, 85140, 85141, 7802, 110919, 147891, 126879, 126880, 150755, 147756, 125922, 125923, 35100, 147755, 97033, 97034, 101000, 97029, 97030, 126695, 126696, 126686, 126687, 126688, 126689, 126690, 126691, 126692, 126705, 152415, 126697, 126698, 126699, 126700, 126701, 126702, 126703, 126704, 97162, 97177, 97171, 97172, 97133, 97168, 97108, 97144, 97145, 97146, 97147, 97148, 97105, 97140, 97159, 97160, 97134, 97167, 97151, 97152, 97103, 97130, 97158, 97131, 153786, 153787, 153788, 153789, 153790, 153791, 153792, 153793, 94910, 94909, 94913, 94914, 94915, 94916, 94862, 94837, 94864, 94858, 94775, 94755, 94756, 94849, 94850, 94851, 94852, 94853, 94854, 94855, 94856, 125928, 94827, 94768, 94769, 94826, 94873, 94874, 94870, 94871, 94817, 53180, 53181, 53182, 100583, 100584};
        expected = 34.89735152237824;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {77127, 77107, 77118, 77129, 77123, 77110, 77111, 77105, 77121, 68980, 68981, 22240, 125025, 125026, 113506, 113507, 114698, 114699, 114700, 124056, 5733, 114799, 5747, 5746, 5734, 5666, 5667, 53880, 13285, 13286, 13287, 106968, 106969, 13607, 13608, 13609, 130543, 155729, 135544, 13288, 13284, 126142, 126143, 126144, 126145, 13281, 130201, 130202, 130203, 130204, 27465, 27466, 27467, 114691, 114692, 114693, 114694, 114695, 114696, 13280, 29850, 29851, 13270, 131731, 48355, 48356, 131732, 131733, 31399, 31400, 31401, 31402, 31403, 27690, 13261, 13262, 82258, 82255, 82256, 128674, 13264, 82835, 36332, 36333, 91548, 91549, 12437, 12438, 82859, 82860, 82861, 82862, 82863, 82864, 101373, 3260, 3259, 102662, 128461, 128462, 126082, 126079, 126080, 126081, 126873, 126874, 24503, 24504, 24523, 24524, 24525, 24526, 24527, 24528, 24529, 24530, 85140, 85141, 7802, 110919, 147891, 126879, 126880, 150755, 147756, 125922, 125923, 35100, 147755, 97033, 97034, 101000, 97029, 97030, 126695, 126696, 126686, 126687, 126688, 126689, 126690, 126691, 126692, 126705, 152415, 126697, 126698, 126699, 126700, 126701, 126702, 126703, 126704, 97162, 97177, 97171, 97172, 97133, 97168, 97108, 97144, 97145, 97146, 97147, 97148, 97105, 97140, 97159, 97160, 97134, 97167, 97151, 97152, 97103, 97130, 97158, 97131, 153786, 153787, 153788, 153789, 153790, 153791, 153792, 153793, 94910, 94909, 94913, 94914, 94915, 94916, 94862, 94837, 94864, 94858, 94775, 94755, 94756, 94849, 94850, 94851, 94852, 94853, 94854, 94855, 94856, 125928, 94827, 94768, 94769, 94826, 94873, 94874, 94870, 94871, 94817, 53180, 53181, 53182, 100583, 100584, 100600, 100599, 51074, 52639, 51663};
        expected = 35.96474796464954;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {75811, 99335, 99336, 151919, 129469, 98025, 97954, 98071, 98072, 98034, 97845, 97981, 98035, 98046, 98047, 98048, 98028, 97933, 97934, 97935, 97864, 98059, 98073, 97862, 98018, 97990, 97991, 97992, 97993, 137096, 98014, 98050, 98053, 98063, 98064, 97919, 97920, 98099, 98012, 97969, 97854, 98045, 97956, 97957, 97958, 97959, 97960, 97961, 97962, 98061, 96570, 96571, 39916, 88426, 149292, 88425, 88440, 88441, 88442, 88443, 88444, 82275, 82276, 135065, 135066, 135069, 135070, 41239, 41238, 82837, 34049, 34050, 82838, 82839, 82840, 82841, 34098, 34099, 82842, 13736, 13737, 82843, 82844, 82845, 82846, 82847, 34733, 82849, 82850, 82848, 82853, 82854, 82856, 82855, 88449, 88450, 82857, 82858, 112759, 112760, 102656, 82834, 82835, 36332, 36333, 91548, 91549, 12437, 12438, 82859, 82860, 82861, 82862, 82863, 82864, 101373, 3260, 3259, 102662, 128461, 128462, 126082, 126079, 126080, 126081, 126873, 126874, 24503, 24504, 24523, 24524, 24525, 24526, 24527, 24528, 24529, 24530, 85140, 85141, 112480, 7816, 7817, 139378, 129063, 112479, 129064, 88319, 88320, 36220, 36221, 13031, 121060, 97082, 97058, 125913, 125917, 125916, 147060, 147059, 147058, 147057, 147056, 147055, 147061, 74110, 74109, 74105, 74107, 13030, 119034, 118972, 74228, 74229, 74227, 74234, 74235, 149226, 149227, 149228, 149229, 130100};
        expected = 36.19470719995424;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {153140, 6991, 6992, 336, 19229, 12224, 147062, 12226, 111834, 68485, 68486, 9531, 767, 40145, 40146, 40147, 40148, 40149, 11838, 156209, 151925, 156210, 151961, 32312, 107223, 107224, 112734, 107225, 123653, 439, 136206, 136207, 131481, 131482, 136293, 136388, 136389, 136383, 136382, 136218, 136217, 132246, 132242, 137973, 137974, 132131, 132127, 131511, 131510, 131508, 131471, 131472, 131473, 131487, 131483, 131470, 131467, 131432, 131430, 131431, 131426, 131427, 131428, 131429, 116056, 116057, 116049, 116050, 111860, 111861, 111858, 502, 28360, 28361, 28362, 55966, 25, 26, 94541, 117907, 94542, 94543, 24, 27, 118064, 28, 118066, 139830, 118061, 111866, 136861, 136868, 136869, 136863, 136867, 136864, 136865, 136866, 118075, 118076, 128460, 118083, 118084, 116210, 116211, 116164, 116200, 116201, 116202, 116339, 116338, 116340, 116341, 116342, 116343, 116344, 116345, 116346, 116347, 116348, 9565, 148147, 148146, 111356, 18828, 18829, 18830, 18831, 19952, 19953, 95609, 94987, 94994, 94990, 94993, 151518, 111402, 111400, 111401, 123466, 123467, 123468, 123469, 123470, 123463, 123465, 123461, 123471, 123472, 123473, 123474, 123475, 123476, 94761, 94860, 94840, 94825, 94865, 94776, 94903, 94904, 94905, 94906, 94809, 94868, 94773, 94774, 94876, 94803, 94845, 94846, 94847, 94760, 94755, 94756, 94849, 94850, 94851, 94852, 94853, 94854, 94855, 94856, 125928, 94827, 20140};
        expected = 36.50347870248179;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {33618, 83789, 83790, 83791, 90040, 90039, 90043, 90038, 90046, 90047, 90048, 90034, 90026, 90056, 90055, 90053, 90057, 130950, 130949, 130948, 130947, 130959, 130960, 130956, 130955, 22778, 139210, 139211, 130946, 139207, 27332, 130958, 125000, 125004, 47193, 47194, 114607, 124959, 124960, 28713, 28714, 8107, 22582, 22581, 22577, 22576, 22612, 22614, 511, 22632, 29637, 29652, 29653, 29654, 10895, 512, 134072, 134073, 5697, 5695, 5696, 5704, 5705, 5728, 5729, 5661, 5742, 5741, 123963, 136753, 136752, 28571, 28572, 28575, 28576, 135041, 629, 630, 643, 111979, 84448, 84436, 111982, 111978, 111964, 111967, 84430, 84426, 111965, 111966, 28470, 28471, 111961, 28460, 28461, 28455, 28456, 146249, 146250, 101356, 111945, 23478, 23479, 111947, 111946, 6323, 127732, 127733, 111954, 111955, 23459, 23460, 111939, 101357, 114902, 9263, 111924, 111923, 111925, 101376, 111926, 28823, 28824, 28836, 28837, 6339, 6340, 140551, 140556, 140554, 82181, 140549, 82185, 82186, 82187, 82208, 82209, 113975, 113976, 39231, 39232, 39233, 39234, 39235, 153429, 153430, 39246, 16184, 9544, 9545, 9546, 123654, 0, 1, 16196, 8273, 103386, 111779, 111780, 646, 111789, 111790, 111791, 61817, 61818, 14185, 14186, 14187, 14216, 14214, 14215, 62310, 62311, 62312, 62288, 62289, 113997, 2612, 107403, 111167, 143144, 113992, 14230, 14231, 62260, 62258, 62256, 62261, 135811, 135812, 62265, 62264, 151226, 151227, 62269, 62278, 83734, 83735, 83736, 61700, 61702};
        expected = 38.43027398503218;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {44464, 44342, 45152, 44508, 128448, 128447, 128446, 128445, 128444, 128443, 28095, 87307, 44261, 45237, 25517, 25518, 25519, 25520, 25521, 109714, 109716, 109717, 109718, 129349, 129350, 129351, 129352, 129353, 129354, 129355, 129356, 129357, 129358, 129359, 87298, 87299, 87300, 87301, 87302, 87303, 87304, 87305, 87306, 135630, 135629, 135634, 135635, 135627, 129929, 129930, 129924, 129925, 129926, 129927, 129928, 143341, 143342, 143343, 143344, 143345, 143346, 143347, 3225, 109785, 109786, 109787, 109783, 3937, 102664, 112178, 8104, 102652, 8090, 8091, 47904, 47900, 112494, 47894, 47892, 47893, 595, 21274, 112498, 517, 112509, 112510, 112508, 112520, 112521, 47908, 112518, 47906, 13601, 518, 47915, 47911, 13641, 13638, 13639, 13640, 28605, 28606, 28620, 28621, 106967, 519, 123970, 28580, 28581, 28582, 123971, 5713, 5712, 483, 123947, 5709, 5708, 5699, 123959, 484, 485, 486, 125021, 125022, 10888, 10894, 29650, 29651, 22633, 22629, 8112, 22611, 22610, 22575, 22578, 119622, 119623, 97350, 97344, 5096, 94624, 135849, 5119, 152104, 151927, 68493, 68494, 768, 19267, 135941, 136527, 14029, 14028, 19253, 19254, 19261, 19262, 111835, 19248, 19247, 12234, 12239, 111834, 68485, 68486, 9531, 767, 40145, 40146, 10432, 10436, 97427, 10438, 14131, 133819, 133818, 14132, 102363, 137084, 137083, 137082, 102362, 14124, 14125, 109029};
        expected = 42.29976659863204;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {32069, 32067, 32066, 104495, 104496, 103960, 103961, 103962, 103963, 103964, 103965, 102947, 102948, 102949, 104436, 104468, 104469, 104470, 104471, 102957, 23655, 112124, 112123, 102942, 112120, 112118, 112122, 81050, 81051, 112116, 102951, 112108, 112109, 115623, 112103, 23260, 23258, 23259, 112097, 23920, 23919, 112098, 24670, 24694, 24698, 24695, 24692, 7212, 112794, 112083, 55934, 30031, 529, 530, 24239, 24240, 9949, 24154, 24152, 24153, 82837, 34049, 34050, 82838, 82839, 82840, 82841, 34098, 34099, 82842, 13736, 13737, 82843, 82844, 82845, 82846, 82847, 34733, 82849, 82850, 82848, 82853, 82854, 82856, 82855, 88449, 88450, 82857, 82858, 112759, 112760, 102656, 82834, 82835, 36332, 36333, 91548, 91549, 12437, 12438, 82859, 82860, 82861, 82862, 82863, 82864, 101373, 3260, 3259, 102662, 128461, 128462, 126082, 126079, 126080, 126081, 126873, 126874, 24503, 24504, 24523, 24524, 24525, 24526, 24527, 124043, 143883, 155684, 155683, 36256, 36241, 36242, 36243, 36252, 36253, 147041, 36238, 36239, 147040, 147042, 121913, 121914, 134617, 134618, 134619, 150396, 150397, 150398, 150631, 150633, 150616, 150617, 150618, 150619, 150620, 150621, 150622, 150623, 150624, 150625, 150626, 150627, 150628, 150629, 152410, 152411, 152412, 152409, 152413, 152414, 91035, 91036, 91037, 91038, 91039, 91040, 91041, 91042, 91043, 91044, 94802, 94771, 94804, 94805, 94806, 94807, 128643, 128661, 144587, 144586, 144585, 144584, 94641, 94637, 94638, 94640};
        expected = 44.30060135019523;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {110161, 74806, 74637, 74835, 74928, 74496, 1406, 1407, 1408, 1409, 1410, 1411, 659, 149294, 126335, 26720, 26723, 26724, 26725, 126441, 126442, 26726, 26727, 90680, 90681, 90682, 90683, 90684, 445, 642, 129022, 30037, 30038, 30383, 30384, 135915, 638, 115437, 115435, 115436, 115605, 633, 634, 635, 5740, 5739, 123963, 136753, 136752, 28571, 28572, 28575, 28576, 135041, 629, 630, 643, 111979, 84448, 84436, 111982, 111978, 111964, 111967, 84430, 84426, 111965, 111966, 28470, 28471, 111961, 28460, 28461, 28455, 28456, 146249, 146250, 101356, 111945, 23478, 23479, 111947, 111946, 6323, 127732, 127733, 111954, 111955, 23459, 23460, 111939, 101357, 114902, 9263, 111924, 111923, 111925, 101376, 111926, 28823, 28824, 28836, 28837, 6339, 6340, 140551, 140556, 140554, 82181, 140549, 82185, 82186, 82187, 82208, 82209, 113975, 113976, 39231, 39232, 39233, 39234, 39235, 153429, 153430, 39246, 16184, 9544, 9545, 9546, 123654, 0, 1, 16196, 8273, 103386, 111779, 111780, 646, 111789, 111790, 111791, 61817, 61818, 14185, 14186, 14187, 14216, 14214, 14215, 62310, 62311, 62312, 62288, 62289, 113997, 113998, 647, 648, 83714, 83715, 138596, 113980, 126639, 153410, 14296, 14295, 153407, 153408, 139845, 152776, 152777, 104055, 104048, 650, 651, 652, 104024, 104019, 104021, 114264, 2489, 2490, 2492, 113985, 124575, 29432, 29433, 29434, 29435, 60678, 60679, 60680, 29437, 29438, 29439, 29440, 9389, 24770, 24771, 48858};
        expected = 44.74349350996712;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {61728, 61731, 143207, 143205, 143206, 84120, 84119, 84118, 84117, 84116, 84115, 84114, 97272, 97271, 97270, 97269, 61858, 61857, 61856, 61845, 61839, 61843, 61846, 61847, 61851, 61852, 61853, 61854, 61855, 61859, 61862, 61869, 61870, 61866, 61860, 61861, 61871, 61872, 61875, 61876, 61873, 61878, 61879, 118396, 155246, 155247, 118410, 118416, 147942, 147943, 118399, 118234, 118235, 118356, 118357, 143943, 143941, 136867, 136864, 136865, 136866, 118075, 118076, 1792, 18843, 18841, 18842, 79252, 18881, 128465, 109515, 128464, 140340, 140341, 140342, 88131, 88130, 127268, 127269, 127270, 36218, 36219, 112478, 88321, 139379, 7818, 7819, 150752, 112481, 126875, 85139, 85132, 85133, 85134, 85135, 85136, 85137, 85138, 24531, 24532, 24505, 24506, 129823, 34737, 150753, 150754, 24508, 24507, 117018, 128463, 102653, 3262, 1776, 101375, 117017, 101350, 117013, 117014, 117015, 12436, 12727, 91547, 91550, 36330, 36331, 82836, 102660, 3932, 102661, 112177, 32102, 31311, 129964, 32105, 130179, 130180, 130181, 130182, 143348, 88356, 143345, 143344, 143343, 143342, 143341, 129928, 129927, 129926, 129925, 129924, 129930, 129929, 135627, 135631, 135628, 135632, 135633, 87306, 87305, 87304, 87303, 87302, 87301, 87300, 87299, 87298, 149179, 149178, 149173, 149177, 149176, 149175, 149174, 119572, 155835, 155834, 155833, 155832, 155831, 155830, 155603, 155602, 155601, 119573, 12439, 109705, 109706, 109707, 109708, 109709, 109701, 109702, 109703, 109704, 155604, 155605, 155606, 155607, 155608, 155609, 155610, 155611, 155612, 44492, 45313, 44935, 44774, 45370, 44671, 44573, 44336, 44793, 44328, 45422};
        expected = 45.19139746521104;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {78336, 78308, 78307, 78323, 78334, 78321, 78320, 99355, 104471, 102957, 23655, 112124, 112123, 102942, 112120, 112118, 112122, 81050, 81051, 112116, 102951, 112108, 112109, 115623, 112103, 23260, 23258, 23259, 112097, 23920, 23919, 112098, 24670, 24694, 24698, 24695, 24692, 7212, 112794, 112083, 55934, 30031, 529, 530, 24239, 24240, 9949, 24154, 24152, 24153, 82837, 34049, 34050, 82838, 82839, 82840, 82841, 34098, 34099, 82842, 13736, 13737, 82843, 82844, 82845, 82846, 82847, 34733, 82849, 82850, 82848, 82853, 82854, 82856, 82855, 88449, 88450, 82857, 82858, 112759, 112760, 102656, 82834, 82835, 36332, 36333, 91548, 91549, 12437, 12438, 82859, 82860, 82861, 82862, 82863, 82864, 101373, 3260, 3259, 102662, 128461, 128462, 126082, 126079, 126080, 126081, 126873, 126874, 24503, 24504, 24523, 24524, 24525, 24526, 24527, 24528, 24529, 24530, 85140, 85141, 112480, 7816, 7817, 139378, 129063, 112479, 129064, 88319, 88320, 36220, 36221, 36222, 36223, 88136, 88127, 88128, 88129, 139483, 18871, 18874, 121063, 113372, 121770, 121071, 121070, 121067, 62349, 62350, 19323, 19324, 129068, 129069, 129070, 129071, 129072, 129073, 129040, 129041, 26863, 26864, 129140, 129142, 96385, 157294, 96372, 96395, 96331, 96310, 96311, 96351, 96365, 96366, 96380, 157304, 157303, 157302, 101099, 101095, 101097, 101096, 157482, 157481, 157480, 157479, 138511, 138510, 138509, 138508, 138507};
        expected = 48.84703543292745;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
    } //compute_path_travel_time

} //path_cost_public

