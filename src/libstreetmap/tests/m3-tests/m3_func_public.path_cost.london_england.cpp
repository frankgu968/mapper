#include <random>
#include <unittest++/UnitTest++.h>
#include "StreetsDatabaseAPI.h"
#include "m1.h"
#include "m3.h"

#include "unit_test_util.h"
#include "path_verify.h"

using ece297test::relative_error;
using ece297test::path_is_legal;
struct MapFixture {
    MapFixture() {
        rng = std::minstd_rand(0);
        rand_intersection = std::uniform_int_distribution<unsigned>(0, getNumberOfIntersections()-1);
        rand_street = std::uniform_int_distribution<unsigned>(1, getNumberOfStreets()-1);
        rand_segment = std::uniform_int_distribution<unsigned>(0, getNumberOfStreetSegments()-1);
        rand_poi = std::uniform_int_distribution<unsigned>(0, getNumberOfPointsOfInterest()-1);
        rand_lat = std::uniform_real_distribution<float>(50.94104, 51.984);
        rand_lon = std::uniform_real_distribution<float>(-1.114989, 0.8949982);
    }

    std::minstd_rand rng;
    std::uniform_int_distribution<unsigned> rand_intersection;
    std::uniform_int_distribution<unsigned> rand_street;
    std::uniform_int_distribution<unsigned> rand_segment;
    std::uniform_int_distribution<unsigned> rand_poi;
    std::uniform_real_distribution<float> rand_lat;
    std::uniform_real_distribution<float> rand_lon;
};

SUITE(path_cost_public) {
    TEST(street_segment_length) {
        double expected;
        double actual;
        
        expected = 10.42693227116269;
        actual = find_street_segment_length(495782);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 20.00820527244874;
        actual = find_street_segment_length(232926);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 20.27583417143372;
        actual = find_street_segment_length(90050);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 30.07970826649835;
        actual = find_street_segment_length(469071);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 34.80357461359635;
        actual = find_street_segment_length(46488);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 37.46037375036017;
        actual = find_street_segment_length(281543);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 41.78763119002204;
        actual = find_street_segment_length(48956);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 43.80040351891365;
        actual = find_street_segment_length(479266);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 44.34854867311026;
        actual = find_street_segment_length(491765);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 48.63960191209385;
        actual = find_street_segment_length(162429);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 50.62685041428993;
        actual = find_street_segment_length(525681);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 52.93657506416565;
        actual = find_street_segment_length(406486);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 59.78842455826334;
        actual = find_street_segment_length(328766);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 71.6322655295692;
        actual = find_street_segment_length(529192);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 73.32898271229277;
        actual = find_street_segment_length(103705);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 81.10522769934866;
        actual = find_street_segment_length(12);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 99.08357447242926;
        actual = find_street_segment_length(357002);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 106.1476818250362;
        actual = find_street_segment_length(492879);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 109.5351592413424;
        actual = find_street_segment_length(397028);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 111.0404367727505;
        actual = find_street_segment_length(143733);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 113.3913820610142;
        actual = find_street_segment_length(306371);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 120.015406766924;
        actual = find_street_segment_length(160747);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 121.2054962254417;
        actual = find_street_segment_length(323608);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 127.6296078455673;
        actual = find_street_segment_length(544024);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 137.068276562182;
        actual = find_street_segment_length(528457);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 157.2659126965743;
        actual = find_street_segment_length(318311);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 157.7746820421419;
        actual = find_street_segment_length(279759);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 370.8153080610136;
        actual = find_street_segment_length(217595);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 666.403651088923;
        actual = find_street_segment_length(487454);
        CHECK(relative_error(expected, actual) < 0.001);
        
        expected = 2648.195778998836;
        actual = find_street_segment_length(442599);
        CHECK(relative_error(expected, actual) < 0.001);
        
    } //street_segment_length

    TEST(compute_path_travel_time) {
        std::vector<unsigned> path;
        double expected;
        double actual;
        
        path = {};
        expected = 0;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 3068, 3067, 3066, 12053, 180464, 177872, 177873, 390735, 390736, 390737, 300336, 467480, 467481, 467482, 467483, 467484, 467485, 467486, 467487, 482465, 482466, 101370, 2345, 243412, 243413, 243414, 300526, 300528, 375697, 341027, 341028, 341029, 454758, 112484, 112489, 36149, 108700, 108701, 108702, 108703, 375691, 341025, 32850, 450879, 431732, 431733, 450872, 481971, 464156, 431729, 75, 76, 512424, 486706, 109351, 3790, 3789, 3788, 32804, 32805, 32806, 32740, 32741, 32742, 32743, 32698, 32699, 32700, 32701, 32670, 32671, 32672, 32673, 32679};
        expected = 14.56584527289254;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {125794, 125793, 125792, 523632, 523631, 283214, 418336, 523639, 283215, 418333, 418332, 162512, 162513, 418198, 418199, 418200, 418201, 418202, 418203, 418193, 418192, 418191, 418190, 418189, 418188, 503801, 53287, 53286, 53285, 53284, 18497, 18498, 18499, 18487, 18488, 302143, 300536, 18490, 503803, 503804, 300550, 18481, 498357, 503802, 508521, 266318, 300538, 21872, 21873, 21874, 21875, 21876, 21877, 21878, 266452, 266453, 297487, 297488, 143389, 143386, 143387, 143388, 518625, 518626, 518627, 518628, 518629, 473847, 473846, 473845, 473844, 473843, 473842, 473841, 473840, 473839, 473838, 473837, 473836, 473835, 473834, 473833, 473832, 328960, 473848, 528501, 528500, 528499, 528498, 528497, 528503, 528519, 528520, 528518, 528512, 528513, 528514, 528515, 528516, 528517, 528521, 528522, 528523, 528524, 528525, 528526, 528527, 528528, 528529, 528530, 528531, 528532, 528533, 528534, 528535, 528536, 528537, 528538, 528539, 528540, 528541, 528542, 528543, 528544, 528545, 528546, 516166, 516167, 266505, 266506, 266507, 266508, 266509, 266510, 266511, 266512, 266513, 266514, 266515, 266516, 266517, 266518, 266519, 266520, 321884, 321883, 321882, 321881, 321880, 279189, 302208, 302207, 302206, 302205, 494209, 494208, 494207, 494201, 494210, 494200, 494203, 484517, 484516, 399783, 399782, 399781, 399780, 330990, 330989, 330988, 330987, 330986, 330985, 330984, 330983, 330982, 330981, 330980, 330979, 283506, 283505, 283504, 283503, 283502, 283501, 283500, 283499, 283498, 283497, 283496, 283495, 283494, 283493, 283492, 283491, 283490, 2441, 411795, 153625, 153626, 153627, 153628, 411933, 411934, 411935, 411936, 291582, 291581, 484511, 484512, 47712, 47713, 285123, 285124, 285125, 285126, 391035, 511469};
        expected = 18.12975649381795;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {436191, 436198, 479313, 297936, 297937, 523608, 523609, 523610, 523607, 523606, 418337, 523638, 523641, 418336, 523639, 283215, 418333, 418332, 162512, 162513, 418198, 418199, 418200, 418201, 418202, 418203, 418193, 418192, 418191, 418190, 418189, 418188, 503801, 53287, 53286, 53285, 53284, 18497, 18498, 18499, 18487, 18491, 18492, 18493, 18494, 538475, 393323, 393322, 479898, 479897, 6438, 6439, 300510, 95817, 160314, 160313, 160359, 160378, 160380, 160381, 356295, 356294, 160396, 160397, 258782, 476868, 476869, 476870, 476871, 184589, 184588, 436077, 184627, 184626, 184805, 184806, 9107, 382777, 252040, 252041, 252043, 382152, 382153, 382154, 252048, 252049, 9106, 252050, 382149, 415438, 382150, 415437, 356421, 289558, 289559, 289560, 289561, 289562, 356430, 356435, 387381, 387382, 387383, 387384, 9044, 9045, 9046, 9047, 9048, 379445, 356414, 356413, 356412, 356411, 356410, 356409, 356408, 356407, 356406, 356405, 356404, 356403, 356402, 356401, 356400, 356399, 356398, 356397, 356396, 356395, 356394, 356393, 498505, 498506, 498502};
        expected = 25.04041975328542;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {423202, 423203, 423204, 423205, 423206, 423207, 264149, 41597, 41598, 41599, 41600, 41601, 41602, 41603, 41604, 41605, 41606, 41607, 41608, 527375, 413254, 527377, 259331, 259332, 259337, 259338, 527378, 527376, 413267, 395574, 527504, 508969, 508959, 508960, 508961, 508974, 508975, 508971, 52748, 52749, 52740, 52738, 52739, 457154, 315937, 315942, 315943, 440289, 377630, 395277, 7216, 7217, 7218, 7219, 7220, 7223, 543632, 7211, 457151, 457152, 285073, 285074, 394141, 285092, 394139, 284006, 394138, 460789, 460790, 460791, 284009, 394145, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 393099, 393097, 459855, 253550, 253549, 253555, 253554, 459852, 459853, 1325, 1326, 1327, 1328, 1318, 1319, 1320, 1321, 416610, 416612, 416613, 416614, 416609, 416615, 416616, 416617, 526293, 526294, 526295, 416604, 526290, 416608, 429700, 429687, 429688, 529751, 529752, 529753, 103037, 418978, 418979, 418980, 429704, 418965, 418964, 418963, 418962, 418961, 429709, 429710, 429711, 429712, 429713};
        expected = 29.28954882282072;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {440798, 440811, 440812, 218780, 218781, 218782, 218783, 218784, 218785, 218786, 218787, 270037, 270038, 270039, 351100, 351104, 351105, 351106, 508128, 508129, 508130, 508115, 508116, 354134, 221345, 507639, 507640, 507641, 507642, 508118, 508119, 508113, 378961, 378962, 378963, 508091, 418375, 378964, 378965, 508095, 508096, 508097, 508098, 378970, 378971, 378972, 378966, 508092, 508093, 508094, 342495, 342496, 378967, 378968, 378969, 378973, 378974, 378975, 378976, 378977, 378978, 378979, 378980, 508107, 508108, 508109, 508110, 508111, 508112, 198600, 112553, 112554, 112555, 112556, 112548, 397396, 492038, 443767, 443768, 397368, 397369, 397364, 397362, 459810, 206719, 206720, 206721, 206722, 397350, 397351, 397352, 397349, 397347, 491942, 397348, 397353, 949, 266774, 266775, 203480, 203481, 266779, 525461, 266780, 477340, 477334, 335634, 450933, 315659, 493027, 493028, 485875, 539091, 539092, 539093, 2113, 2114, 484608, 515354, 479201, 479200, 2111, 106668, 311786, 330316, 330317, 330318, 330319, 330320, 298190, 298191, 298192, 298193, 298194, 298195, 267795, 267794, 481232, 481226, 21354, 297228, 297227, 297226, 297225, 297224, 297223, 297222, 297221, 297220, 297219, 297218, 297217, 297216, 297215, 297214, 297213, 297212, 297211, 298161, 298160, 119870, 119869, 119871, 297250, 119872, 119873};
        expected = 30.34181035686535;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {105465, 105466, 105467, 105468, 105469, 105470, 105471, 105472, 105473, 370852, 491708, 246831, 246832, 371765, 337463, 124937, 370845, 370846, 370847, 243563, 243564, 243565, 243566, 243567, 517365, 517366, 517367, 517368, 358083, 358084, 405730, 405731, 405732, 405733, 317492, 317485, 317486, 317487, 317488, 317489, 70033, 413597, 407384, 498370, 498369, 498368, 531986, 531985, 164942, 525936, 524564, 524563, 412478, 412479, 412473, 527431, 527432, 527433, 527434, 527435, 527436, 527437, 527438, 527439, 527440, 527441, 527442, 527443, 527444, 527445, 524736, 383601, 383599, 411610, 411611, 508977, 7204, 7205, 7206, 7207, 7200, 7213, 508967, 508968, 508969, 508959, 508960, 508961, 508974, 508975, 508971, 52748, 52749, 52740, 52738, 52739, 457154, 315937, 315942, 315943, 440289, 377630, 395277, 7216, 7217, 7218, 7219, 7220, 7223, 543632, 7211, 457151, 457152, 285073, 285074, 394141, 285092, 394139, 284006, 394138, 460789, 460790, 394540, 460796, 394543, 526786, 526787, 526795, 264160, 264161, 264162, 1829, 526798, 97679, 526796, 417939, 97678, 333047};
        expected = 32.27337030134697;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {434342, 492662, 434341, 434321, 434322, 267464, 42158, 42151, 42150, 42155, 42160, 389644, 16757, 42138, 42139, 42133, 389642, 16755, 16754, 16753, 16752, 16751, 40144, 16744, 16745, 16746, 16738, 40141, 306260, 448600, 448599, 306329, 306259, 389639, 389638, 38365, 40104, 35691, 35692, 35693, 40101, 305624, 305625, 306240, 306239, 306238, 37334, 306173, 305644, 306241, 35602, 35601, 40112, 35590, 35589, 35588, 35587, 443594, 443595, 296361, 375826, 486046, 491277, 491278, 491279, 39662, 39664, 491285, 39417, 491283, 491284, 56617, 56618, 56624, 56621, 56626, 56630, 56631, 486047, 56610, 56605, 56612, 73677, 487127, 487128, 487129, 351784, 351785, 351786, 351787, 351788, 304914, 487123, 487124, 487125, 487126, 357202, 357196, 490208, 490209, 490210, 490211, 73688, 73681, 73682, 73683, 73689, 282891, 487130, 426308, 396741, 355662, 355660, 426299, 426300, 306793, 306794, 306795, 306796, 355663, 355664, 306797, 306798, 306799, 306800, 306801, 306802, 426309, 426310, 426307, 426306, 426305, 426304, 426303, 426301, 527178, 527179, 503412, 503411, 157923, 157922, 157921, 509936, 509935, 509934, 509933, 509932, 509931, 509930, 509929, 509928, 509927, 509937, 503339, 157906, 157905, 157904, 157903, 157902, 157915, 157914, 157913, 157912, 157911, 157910, 157909, 157908, 157907, 282097, 282099, 431675, 497902, 497901, 249091, 485439, 485438, 485437, 485436, 294662, 294661, 489434, 489433, 489432, 489431, 489430, 489429, 489428, 358594, 358593, 358592, 358591, 341825, 341824, 341823, 341822, 341821, 341820, 341819, 341818, 341817, 341816, 341815, 300150, 341803, 341804, 341805, 423320, 281607, 395110, 395111, 395112, 395113, 395114, 295281};
        expected = 32.78503140396819;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {442474, 196639, 196638, 309627, 309628, 309629, 309630, 30063, 30064, 30065, 474320, 474321, 474322, 474323, 474324, 474325, 474326, 281433, 281431, 281432, 264974, 264975, 245199, 367770, 309617, 309618, 367506, 367504, 477558, 410880, 6615, 6616, 6617, 6618, 6619, 410866, 410867, 410868, 281337, 451345, 410871, 7622, 7623, 65943, 408851, 5507, 380961, 380960, 408894, 408895, 272882, 436652, 275751, 275752, 380955, 380958, 451246, 451251, 65877, 65876, 436656, 5505, 5506, 5504, 380942, 380951, 380954, 380946, 3804, 3805, 380953, 380945, 336931, 336932, 436641, 291946, 291947, 291948, 65944, 451247, 1340, 450212, 338144, 284903, 284904, 338140, 715, 171452, 171451, 171462, 171463, 171464, 171465, 281826, 281827, 476019, 452102, 286971, 206723, 422902, 459899, 459900, 459901, 450188, 218943, 218944, 218945, 264838, 264842, 264843, 264850, 264849, 459896, 459893, 382302, 382303, 382296, 382300, 382301, 191213, 191214, 12777, 367685, 184820, 184821, 184822, 461697, 461696, 461695, 461694, 85926, 85925, 85924, 85923, 475410, 475409, 475408, 535688};
        expected = 33.77401040888751;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {65004, 493136, 493135, 493134, 493133, 493132, 493131, 493130, 493129, 65219, 449738, 472630, 315656, 315655, 315654, 283927, 283928, 516366, 516367, 516368, 516365, 477174, 477175, 513473, 513472, 543978, 543977, 543976, 543975, 283933, 366573, 167540, 167541, 167539, 518276, 18054, 54691, 54692, 54693, 54694, 54695, 54696, 246516, 246517, 246518, 246519, 246520, 246506, 246507, 246508, 50172, 50171, 50170, 50169, 50168, 50167, 283922, 283921, 283920, 283919, 283918, 283917, 480094, 480093, 17633, 110412, 465312, 465313, 465314, 465315, 465316, 465317, 465318, 465319, 465320, 465321, 465322, 465323, 465324, 17632, 17631, 17630, 366302, 366301, 17616, 17615, 17614, 17613, 17612, 17611, 181704, 181705, 181706, 181707, 181709, 406351, 381338, 381339, 381340, 32845, 32846, 32847, 32848, 291145, 111250, 111251, 111252, 111253, 111254, 111255, 222298, 111256, 160101, 160100, 160099, 160098, 160097, 543123, 320707, 320708, 320709, 320710, 320711, 489795, 489794, 489793, 489791, 217675, 217674, 489789, 489788, 489787, 489786, 489785, 489784, 320720, 18634, 18635, 18636, 18637, 18638, 256703, 256702, 256701, 256700, 279188, 33438, 33437, 33436, 33435, 33434, 33433, 90468, 90467, 313540, 301869, 52730, 52731, 52732, 256704, 256705, 256706, 256707, 256708, 256709, 256710, 399780, 399781, 399782, 399783, 484516, 484517, 484513, 494205, 494206, 472353, 494207, 494208, 494209, 302205, 302206, 302207, 302208, 279189, 321880, 321881, 321882, 321883, 321884, 315480, 315481, 315482, 315483, 315484, 315485, 315486, 315487, 315488, 315489, 315490, 442979, 442978, 11782, 11783, 11784, 350364, 350365, 350366, 350367, 350368, 350369, 350370, 350371, 350372, 350373, 350374, 350375, 11785, 11786, 11787, 11788, 11789, 11790, 11791, 532672, 532673, 532674, 297500, 297496, 297497, 297498, 297499, 532747, 532748, 532749, 532750, 11781, 532742, 302675, 302676, 302677, 284776, 266565, 266566, 266567, 302146, 302147, 4940, 95789, 300562, 519241, 519242, 479895, 3733, 479898, 479897, 6438, 6439, 300510, 95817, 160314, 160313, 160359, 160378, 160380, 160381, 356295, 356294, 160396, 160397, 258782, 476868, 132103, 325863, 325864, 325859, 325856, 325855, 47664, 160415, 47639, 47640, 47641, 47642, 47643, 47644, 1086, 358247, 358248, 358249, 358250, 479795, 479801, 479796, 479797, 479798, 479799, 479800, 82014, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 446235, 446236, 446237, 446238, 446239, 446240, 446241, 446242, 446243, 446244, 446245, 446246, 446247, 446248, 446249, 446250, 446251, 446252, 446253, 446254, 446255, 446256, 446257, 446258, 446259, 108818, 108819, 378143, 378144, 378145, 378146, 407, 408, 409, 289794, 289795, 289796, 292961, 292962, 292963, 292964, 292965, 292966, 292967, 453318, 453319, 453320, 453321, 194862, 108713, 108712, 108709, 108710, 108711, 289733, 289734, 289735, 289736, 110, 111, 112, 113, 114, 115, 116, 117, 890, 891, 892, 282397, 282398, 512661, 282477, 282478, 541179, 512656, 512657, 512658, 512659, 512660, 1502, 1503, 1504, 406302, 406301};
        expected = 42.24924500937187;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {488716, 488715, 488714, 488713, 488712, 466524, 466523, 466522, 466521, 466520, 496723, 496722, 496721, 496725, 496718, 496705, 496711, 496720, 257671, 30898, 30897, 512270, 83905, 532832, 532831, 532830, 509912, 509911, 509910, 509909, 509908, 509907, 510273, 196177, 510270, 510268, 268978, 268977, 268976, 525641, 216673, 286332, 286331, 286330, 450360, 450359, 450361, 471557, 103207, 450363, 103208, 175329, 459053, 14152, 14113, 363680, 1516, 521288, 521290, 521291, 206266, 501318, 285967, 285968, 285969, 285970, 285971, 285972, 285973, 285974, 285975, 285976, 285977, 285978, 470027, 470039, 470040, 541457, 470023, 470024, 380000, 380001, 535095, 535094, 538831, 459048, 490991, 501361, 501360, 117882, 542614, 542625, 542553, 542607, 542606, 467225, 467223, 467224, 467229, 367640, 467226, 465987, 492920, 88988, 492908, 475766, 492911, 492912, 492913, 492914, 492915, 492916, 289181, 289182, 511516, 132558, 285097, 280046, 461455, 461456, 461457, 272805, 272806, 272807, 272808, 272809, 272810, 272811, 272812, 272813, 272814, 272815, 272816, 272817, 272818, 272819, 272820, 195969, 195970, 195977, 541671, 541682, 316391, 540725, 540724, 540723, 540722, 540721, 540720, 540719, 540718, 540717, 540715, 540714, 540713, 540712, 540711, 540710, 540709, 21649, 540716, 538375, 538374, 244395, 244394, 244393, 244392, 244391, 244390, 244389, 244388, 244387, 244386, 244385, 465635, 465636, 178699, 448921, 448920, 448919, 448918, 448343, 448342, 448341, 448340, 448339, 448338, 448337, 448336, 448335, 448334, 448333, 448332, 448331, 448330, 448329, 448328, 448327, 448326, 448345, 448344, 21661, 362355, 165464, 165463, 165462, 165461, 165460, 165459, 165458, 165457, 165456, 165455, 165454, 165453, 165452, 165451, 165450, 165449, 165448, 165447, 165446, 165445, 165444, 165443, 165442, 165441, 165440, 143665, 143664, 143663, 143666, 41485, 51908, 288586, 288587, 288588, 165465, 541721, 541720, 541719, 541718, 541717, 541716, 541726, 541725, 541724, 541723, 541722, 46399, 46398, 19575, 19576, 19577, 19578, 19579, 19580, 20047, 20048, 363966, 363965, 363964, 363963, 363962, 363967, 439019, 439018, 19590, 20082, 20083, 20084, 20085, 20086, 252792, 252793, 252794, 252795, 252796, 252797, 252798, 252799, 252800, 252801, 438973, 438978, 438979, 438980, 438981, 438982, 438983, 438984, 438985, 493054, 493053, 493052, 493051, 493050, 493049, 76783, 493047, 493048, 76780, 76781, 76782, 493059, 493060, 493061, 112342, 112343, 100913, 100914, 100915, 100916, 259022, 259021, 512886, 41243, 302693, 41655, 436337, 98929, 98930, 98931, 98932, 137145, 450395, 500050, 450400, 450399, 533074, 533066, 533067, 533071, 533068, 533069, 533002, 532970, 532979, 532973, 532971, 532977, 532975, 180405, 180430, 180429, 180428, 180427, 180426, 180425, 180424, 180423, 180422, 192641, 192640, 192639, 192638, 192637, 500046, 500045, 500044, 99021, 99020, 99019, 99018, 99017, 99016, 99015, 99014, 99013, 99012, 99011, 99010, 99009, 99008, 99007, 99006, 465796, 465795, 465794, 465793, 465792, 465791, 465790, 465789, 465788, 465787, 465786, 98724, 98723, 98722, 98424, 477828, 477827, 477826, 477825, 477824, 98397, 8383, 8384, 8385, 8386, 8387, 8388, 270680, 44478, 44473, 81594, 270683, 270682, 378482, 378481, 378480, 378479, 378478, 378477, 378476, 378475, 378474, 378473, 76043, 76044, 76045, 316842, 76046, 76047};
        expected = 42.34295950047864;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {32247, 32243, 110970, 205378, 205377, 109864, 109863, 109865, 445784, 493080, 493081, 493082, 493083, 493084, 493085, 493086, 493087, 493088, 31753, 205312, 205303, 205304, 205305, 205306, 205307, 205308, 205309, 205310, 205311, 445760, 507071, 507072, 507073, 445761, 445762, 449957, 110783, 110784, 110777, 110778, 507070, 511545, 387772, 387771, 387770, 387769, 387768, 446547, 387766, 387767, 9531, 9527, 108896, 387765, 153333, 478109, 153330, 382561, 153332, 159975, 330460, 478073, 478074, 121066, 478087, 478093, 478094, 478095, 478096, 478097, 9524, 9525, 436666, 143795, 143796, 438796, 437300, 387773, 34740, 143790, 387761, 387755, 387763, 387762, 141758, 238080, 542185, 143809, 143810, 542187, 143811, 1585, 292051, 453407, 435859, 143814, 542176, 143815, 280988, 280989, 57584, 185387, 57585, 57583, 185388, 185391, 542184, 57468, 57476, 387622, 57475, 387621, 57474, 57473, 356055, 356056, 57469, 53749, 542180, 327423, 57463, 57462, 57461, 542179, 57460, 387815, 57454, 57453, 542182, 53751, 1492, 1493, 304251, 304252, 304250, 304240, 304242, 304243, 304244, 357661, 357662, 176643, 219731, 304260, 304261, 22805, 250187, 512312, 421035, 164402, 164403, 512311, 421033, 421029, 421030, 421031, 250185, 328735, 446207, 292385, 488208, 488209, 488210, 488211, 292815, 292816, 292817, 292818, 292819, 292820, 359983, 312958, 312959, 292362, 292363, 488214, 488215, 488216, 520455, 520457, 520459, 359982, 520462, 520461, 292805, 520107, 520106, 520105, 520104, 520103, 520102, 520101, 520100, 520099, 520098, 292374, 292373, 292372, 34639, 34638, 71734, 71733, 71732, 71731};
        expected = 42.56817593417736;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {162313, 162314, 162315, 69413, 69414, 545896, 545895, 545894, 545893, 482556, 482555, 482554, 482553, 113887, 113886, 113885, 113884, 113883, 113882, 113881, 160841, 160840, 160839, 481194, 9777, 9776, 9775, 9774, 9773, 9772, 9771, 9770, 9769, 9768, 9767, 335637, 474393, 474392, 474391, 474390, 474389, 474388, 474387, 474386, 474385, 474397, 474398, 474399, 545887, 545888, 481664, 481665, 542877, 542872, 542878, 83856, 354904, 354905, 354906, 354907, 354901, 456494, 21650, 545882, 545883, 545884, 545885, 545886, 445844, 456499, 456500, 456501, 456502, 456503, 456504, 456505, 445843, 69579, 69580, 69581, 69582, 545870, 545871, 545872, 288224, 288225, 474185, 290803, 456511, 456512, 448350, 389233, 456915, 456914, 456913, 456912, 456910, 456909, 405811, 405810, 405809, 405808, 405807, 405806, 405805, 405804, 405803, 405802, 405801, 405800, 405799, 405798, 405797, 405796, 405795, 456922, 456921, 405813, 405812, 456908, 456907, 456906, 456905, 456904, 456903, 456902, 466119, 466118, 466123, 466120, 466121, 466122, 339060, 522174, 195968, 195967, 195966, 497388, 497387, 497395, 21599, 325917, 325916, 325915, 325914, 325913, 325912, 325911, 325910, 325909, 325908, 325907, 325906, 325905, 325904, 325903, 325902, 325901, 325900, 253010, 253009, 253008, 253007, 253006, 253005, 253004, 253003, 253002, 21647, 285097, 132558, 511516, 289182, 289181, 492916, 492915, 492914, 492913, 492912, 492911, 475766, 190639, 492909, 492910, 88988, 341043, 465969, 105529, 492921, 467228, 268931, 199140, 467222, 284366, 543045, 117882, 501362, 484529, 501366, 459048, 538831, 535094, 535095, 380001, 380000, 470024, 470023, 541457, 470025, 470037, 470035, 285978, 285977, 285976, 285975, 285974, 285973, 285972, 285971, 285970, 285969, 285968, 285967, 501318, 206266, 471509, 287012, 521286, 117436, 363681, 521303, 26879, 175330, 504132, 459050, 103210, 450365, 450367, 15290, 450359, 450360, 286330, 286331, 286332, 525642, 15289, 15288, 15287, 15286, 15285, 65913, 65914, 539840, 539841, 453502, 420685, 521162, 521163, 521164, 521159, 521152, 521153, 521151, 521154, 521157, 521158, 473145, 521165, 473139, 493281, 465325, 465326, 493272, 493256, 493257, 466095, 348332, 466085, 466083, 466100, 466096, 545942, 466104, 5160, 5161, 261220, 261221, 261222, 261223, 261224, 261225, 261226, 261227, 261228, 261229, 261230, 261231, 261232, 261233, 261234, 261235, 261236, 545497, 313828, 313829, 487841, 534588, 534387, 534231, 534232, 545495, 231993, 545496, 231994, 471799, 471800, 471794, 337497, 471803, 471812, 337498, 337499, 337500, 532719, 532720, 540840, 337496, 537078, 537077, 537076, 537075, 537074, 537073, 537072, 459366, 487840, 261252, 261251, 261250, 261249, 261248, 261247, 261246, 261245, 261244, 261243, 261242, 261241, 261240, 261239, 479301, 479300, 479299, 341389, 494454, 449331, 269433, 269432, 160200, 160199, 360152, 172822, 172823, 428520, 428523, 428521, 428522, 360128, 231020, 231021, 360121, 130201, 444268, 465253, 197392, 197391, 205755, 205756, 56188, 391881, 391879, 182772, 64139, 338996, 78903, 78901, 78899, 327230, 327231, 356083, 356081, 60953, 3451, 3452, 488042, 338995, 291502, 6453, 291500, 291512, 291506, 291507, 291508, 291509, 291510, 291511, 292265, 292266, 481290, 6486, 481293, 481297, 481298, 6487, 6488, 6489, 6490, 6491, 6492, 6493, 6494, 360005, 360006, 360007, 360008};
        expected = 44.13434128829679;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {34452, 34453, 363154, 363155, 363156, 363157, 363158, 363159, 363160, 363161, 363162, 363163, 363164, 363165, 363166, 363167, 363168, 408459, 408458, 408457, 408456, 408455, 408454, 408453, 408452, 408451, 408450, 408449, 408466, 408467, 408898, 417639, 417640, 515100, 515099, 515098, 515103, 515102, 515101, 356847, 356846, 356845, 356844, 356843, 356855, 36411, 36410, 36409, 36408, 1724, 1725, 1726, 109124, 1641, 1642, 1643, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 109068, 109069, 109070, 109071, 109072, 109073, 514094, 1470, 1471, 1472, 1473, 470449, 162574, 162573, 394625, 332075, 537705, 537704, 537703, 537702, 537701, 537706, 183279, 183278, 183277, 183276, 183275, 183274, 183273, 299119, 299118, 299117, 299116, 299115, 299114, 299113, 299112, 299111, 299110, 299109, 299108, 299107, 299106, 299105, 299104, 299103, 299102, 299120, 184253, 184252, 184251, 184250, 184249, 184248, 184247, 184246, 184245, 484537, 484536, 501091, 184244, 484535, 483135, 467289, 467288, 467291, 467290, 467293, 467292, 467296, 467295, 467294, 1469, 1468, 1467, 18745, 470256, 470258, 470261, 109504, 436658, 292050, 453405, 159966, 542186, 34782, 143808, 542188, 143806, 527816, 527817, 487760, 238079, 378351, 479019, 479032, 143793, 487757, 143794, 479000, 487759, 487756, 487754, 487755, 10199, 245710, 387754, 356448, 387759, 387760, 387879, 272860, 397147, 460154, 418038, 397131, 506657, 506777, 506663, 397132, 397133, 397137, 397136, 397135, 397134, 396876, 506660, 506659, 159856, 272853, 506425, 506405, 88120, 88126, 88127, 88145, 506420, 272856, 88146, 23641, 272854, 506408, 26416, 4670, 397145, 397143, 64252, 64251, 506422, 506404, 506410, 506421, 506424, 66231, 398956, 398954, 66229, 399170, 64253, 506407, 59181, 506433, 506439, 386650, 454955, 64256, 341048, 341049, 64258, 77882, 77883, 12476, 77895, 77894, 389765, 389752, 389751, 389750, 329073, 389769, 389768, 389767, 389766, 329074, 336048, 336045, 336046, 336047, 389764, 389763, 389762, 389761, 389760, 389759, 389758, 389757, 389756, 389755, 389754, 389753, 455003, 455004, 12471, 12472, 12473, 389749, 237359, 237360, 504390, 328482, 336050, 389771, 389770, 498973, 84209, 84208, 324221, 19250, 389783, 315292, 315293, 315294, 389784, 19248, 19262, 389772, 315282, 315287, 315288, 315289, 389782, 454996, 179791, 179792, 235608, 235615, 235610, 235616};
        expected = 47.09861171468676;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {121196, 121197, 212032, 212031, 212030, 119084, 283599, 283600, 297913, 186394, 495680, 495679, 495678, 495677, 495676, 495674, 495673, 186393, 186392, 420530, 420531, 420532, 297909, 297908, 2211, 2212, 2213, 2214, 2215, 421882, 421881, 186387, 186388, 186386, 422673, 422674, 297557, 297558, 297559, 220380, 220381, 220382, 220383, 220384, 220385, 220386, 220387, 220388, 220389, 220390, 220391, 304044, 304045, 479325, 479320, 422945, 422944, 422943, 422942, 422946, 66834, 66833, 66832, 66831, 66830, 66829, 212105, 212104, 212103, 288438, 288437, 18963, 18962, 18961, 18960, 272701, 272702, 272700, 272699, 272698, 69920, 69919, 473501, 473502, 212123, 473500, 212124, 212125, 212126, 58356, 58357, 479305, 479309, 2105, 2107, 2108, 170269, 192825, 192826, 170263, 170266, 170267, 375294, 375295, 375296, 375297, 335633, 448296, 335632, 477333, 266778, 525462, 397354, 203478, 203479, 266776, 266777, 397335, 397325, 397336, 491938, 397337, 397331, 397326, 397327, 1336, 376110, 376108, 376122, 452103, 281828, 716, 717, 718, 171461, 171460, 171450, 171453, 452097, 452101, 452098, 452100, 146442, 146445, 354696, 286974, 452094, 452092, 338159, 172365, 376350, 253482, 253481, 253480, 253479, 141421, 387962, 141422, 57033, 57032, 393231, 405674, 405675, 450206, 393235, 173144, 393234, 270170, 465674, 394339, 394152, 394158, 394153, 284010, 394155, 394156, 284011, 394544, 284012, 460795, 264162, 526793, 526794, 394541, 460793, 460792, 284005, 394136, 285093, 394137, 285094, 7212, 285077, 285078, 457153, 7220, 7223, 7224, 483556, 483557, 483551, 483552, 65388, 543620, 543621, 543622, 543623, 543624, 543625, 543626, 543627, 543628, 373155, 281492, 526566, 526577, 526584, 526576, 526578, 526579, 526580, 526581, 526586, 337617, 337616, 337615, 399731, 396835, 396836, 396837, 396838, 396839, 396840, 396831, 337619, 331980, 331979, 331978, 331977, 473082, 473081, 473080, 473079, 399730, 544776, 229738, 229733, 526596, 517800, 461825, 526597, 399837, 348481, 526545, 526547, 329076, 399964, 399960, 399965, 371079, 526557, 526556, 399665, 399664, 399663, 526552, 526551, 526550, 526549, 526548, 176615, 176614, 176613};
        expected = 50.40715593285309;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {419191, 419193, 419192, 418063, 418064, 204355, 204356, 204357, 204358, 110279, 510210, 510209, 510206, 107895, 236382, 236383, 236384, 236385, 236386, 236387, 236388, 236389, 236390, 236391, 236392, 107896, 15525, 294614, 538869, 538870, 538871, 538872, 538873, 538874, 538875, 538876, 538877, 209221, 209217, 209218, 209219, 209220, 15526, 15527, 436263, 436264, 436265, 436266, 436267, 110295, 15931, 15932, 15933, 273341, 253858, 447116, 447115, 447114, 368795, 368818, 368817, 368816, 368815, 368814, 368813, 368812, 436289, 368756, 368755, 368754, 368758, 368757, 373969, 253861, 253860, 253859, 373971, 373970, 1392, 1391, 1390, 1389, 1388, 1387, 3369, 3370, 3371, 368422, 368423, 368424, 368425, 368389, 368390, 368391, 1383, 440337, 440338, 369045, 369046, 369047, 369048, 369049, 369050, 369051, 369052, 369053, 369054, 369055, 369056, 369057, 369058, 301190, 406270, 406271, 368987, 368994, 368995, 368996, 152207, 152205, 152206, 439737, 439735, 406273, 406274, 173186, 44343, 450190, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 1923, 474067, 474068, 374710, 374711, 374712, 44705, 363663, 363665, 387967, 493759, 493771, 475199, 475200, 38419, 461733, 219576, 219577, 219578, 129427, 129430, 129431, 129432, 129438, 129437, 378116, 129439, 129440, 465541, 465542, 188342, 188343, 188371, 188372, 188373, 220138, 103954, 103955, 378117, 378118, 378119, 378120, 472926, 34587, 34584, 34585, 34586, 495028, 495029, 495030, 495031, 495032, 495033, 495034, 495035, 514389, 267202, 514395, 514394, 482662, 514386, 514387, 514388, 544462, 82947, 125438, 378121, 378122, 267222, 267223, 267228, 363920, 363921, 363922, 268887, 268888, 267229, 483251, 483254, 483248, 269713, 489522, 484322, 417901, 245697, 488886, 245695, 323657, 126406, 54341, 488612, 266798, 488603, 488590, 479834, 484782, 488593, 488613, 488594, 539109, 539110, 1232, 1231, 1230, 1229, 1228, 1227, 1226, 539826, 539914, 539915, 507939, 539609, 539610, 539611, 539586, 539587, 539588, 539589, 539602};
        expected = 55.24825221657884;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {323564, 465998, 10312, 323563, 364196, 364193, 364194, 320980, 259482, 259483, 929, 930, 485834, 485831, 485832, 485833, 276130, 533958, 259484, 533955, 533954, 486734, 541567, 321587, 321588, 296757, 485917, 485918, 265161, 147112, 147113, 511374, 278307, 517829, 199147, 199146, 296801, 486731, 240866, 214862, 214861, 276702, 276703, 461935, 461934, 2178, 485395, 390104, 485394, 331733, 540851, 485390, 540859, 485377, 485378, 149635, 149631, 149632, 149633, 149634, 540860, 540861, 398146, 469239, 514143, 475548, 475549, 475550, 475551, 376771, 475553, 475554, 463415, 405583, 405584, 457325, 950, 353951, 453877, 475566, 339828, 173264, 288794, 173263, 17316, 463528, 17312, 17308, 363854, 363855, 376765, 376766, 483841, 283912, 283913, 283914, 283915, 266734, 21411, 513233, 279363, 522182, 522274, 522180, 522178, 519002, 21413, 279364, 522160, 522159, 522158, 521276, 521275, 521274, 326187, 398361, 398360, 326196, 326197, 326198, 326199, 326200, 326201, 326202, 326211, 326212, 184168, 184167, 184166, 184165, 184164, 184162, 184163, 184170, 184169, 455951, 306499, 306498, 306497, 535577, 535576, 535575, 535574, 535573, 107798, 350289, 522073, 326372, 245117, 245116, 245115, 245114, 245113, 245112, 245111, 245110, 71596, 71595, 71594, 71593, 71592, 289836, 289835, 289834, 289833, 289832, 289831, 289830, 289829, 289828, 289842, 289841, 289840, 289839, 289838, 289837, 289848, 289843, 289847, 524053, 524052, 524051, 524050, 524049, 524048, 524047, 472202, 472201, 295914, 295913, 295912, 295911, 295910, 295909, 295908, 71585, 71584, 71587, 518456, 301525, 301526, 301527, 210567, 4077, 471137, 471141, 471142, 471143, 471144, 435825, 435827, 435828, 435829, 435830, 471145, 471146, 205013, 268622, 513195, 435648, 268619, 338623, 268625, 284060, 284061, 283037, 284048, 283038, 283039, 283040, 283041, 264255, 264256, 264257, 539101, 539099, 539100, 168198, 168199, 168196, 264911, 380941, 380940, 338142, 338131, 284538, 284539, 284530, 284531, 146450, 65942, 451248, 451249, 291949, 291950, 291951, 291945, 436642, 65941, 336929, 336930, 380947, 380948, 380949, 264709, 380944, 380943, 380952, 380950, 65939, 65940, 436644, 436645, 436650, 436651, 65875, 65874, 451252, 451245, 380957, 380956, 275749, 275750, 436648, 436649, 1862, 1863, 408893, 380959, 380962, 408853, 7627, 372822, 367882, 380980, 451336, 451337, 402870, 151081, 325779, 451338, 451341, 349161, 536539, 536540, 353313, 353314, 353310, 546314, 546315, 546316, 546306, 402892, 461018, 141310, 546320, 402895, 402896, 546308, 546317, 141308, 141309, 369433, 369434, 542402, 542403, 400193, 400194, 369428, 369429, 369430, 369431, 369432, 542386, 399147, 399148, 399149, 399150, 399151, 542389, 542385, 504237, 544829, 544830, 544831, 544832, 544833, 544834, 544835, 544836, 544837, 544838, 544839};
        expected = 55.46276568600931;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {501122, 270466, 359155, 293018, 293019, 480067, 194870, 480075, 257708, 257675, 288786, 532826, 521830, 521831, 352046, 543495, 543496, 352053, 543497, 352045, 287011, 543498, 387994, 387995, 449307, 542269, 350084, 473850, 473851, 502724, 472255, 514146, 514147, 514145, 183479, 282346, 282345, 183483, 502732, 502737, 502735, 44499, 44498, 296599, 296598, 296597, 296617, 23327, 46185, 46186, 46187, 46188, 82005, 503964, 502198, 502199, 491775, 367822, 367823, 484747, 511776, 520203, 248023, 248024, 248025, 248026, 344808, 485070, 484487, 484488, 358320, 458411, 458412, 468573, 484746, 468589, 484740, 484743, 484741, 289698, 288628, 268972, 465628, 465629, 268973, 484716, 280572, 280571, 29652, 485798, 485799, 485800, 484694, 412217, 412218, 29506, 29507, 29508, 29509, 29510, 29511, 484698, 484699, 484700, 484695, 484696, 465013, 484711, 484712, 484697, 3715, 470531, 470532, 470533, 470534, 470535, 459633, 511472, 511473, 511474, 511475, 511476, 511477, 511468, 511469, 511470, 511471, 3717, 3718, 3719, 3720, 3721, 3722, 3723, 3724, 3725, 3726, 3727, 3728, 277197, 277198, 100704, 476592, 100707, 288518, 288517, 3686, 3685, 3684, 3675, 3676, 218198, 218199, 218200, 218201, 342331, 218204, 218205, 512764, 471301, 512765, 3660, 299865, 512762, 301860, 512763, 512842, 512769, 299500, 512827, 512837, 512833, 512831, 512828, 512838, 512839, 489799, 376019, 489798, 376025, 376024, 376018, 376017, 376016, 376021, 376020, 376023, 376022, 513073, 513070, 513078, 513079, 513065, 513066, 513067, 513068, 513069, 512965, 512964, 193846, 1032, 1033, 512989, 512984, 512985, 512986, 512987, 534258, 297529, 297530, 297531, 297532, 335626, 40050, 40051, 543995, 363473, 480953, 40054, 363469, 376012, 95816, 484877, 132135, 363583, 160315, 160310, 160309, 160311, 160312, 160359, 160378, 160380, 160381, 356295, 356294, 160396, 160397, 258782, 476868, 476869, 476870, 476871, 184589, 184588, 436077, 184627, 184626, 184805, 184806, 184807, 159730, 159729, 289549, 289550, 289551, 389373, 389370, 389371, 257384, 257382, 257383, 153309, 393118, 465546, 355636, 389379, 389378, 474520, 474516, 231340, 474518, 181543, 231344, 173347, 474517, 179810, 179809, 41624, 41625, 393372, 41627, 41629, 41630, 393371, 151316, 393376, 393377, 160219, 393507, 393508, 393511, 393506, 357658, 393518, 393519, 393520, 457963, 104073, 41613, 475985, 204257, 53831, 53838, 53837, 84123, 84124, 84125, 351254, 84118, 84119, 84122, 490663, 351719, 351718, 351717, 351716, 351715, 351714, 351713, 351712, 351711, 151148, 537920, 537919, 537918, 537917, 537916, 537915, 309227, 151152, 309269, 445137, 213966, 213965, 213964, 213963, 213962, 151147, 59760, 59757, 394474, 394481, 387476, 387475, 387474, 214398};
        expected = 57.54048765927073;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {330529, 330561, 330562, 330563, 330564, 330565, 330566, 330567, 330568, 330516, 330512, 330569, 330491, 330490, 330489, 291408, 6618, 6619, 410866, 410867, 410868, 281337, 451345, 410871, 490080, 397466, 397468, 380982, 380979, 380980, 451336, 451337, 402870, 151081, 325779, 451338, 451341, 451342, 536536, 536537, 395252, 395258, 211274, 211275, 250160, 250161, 250162, 395250, 540107, 540106, 540105, 540104, 395247, 395246, 395249, 9467, 540021, 540014, 540113, 540114, 540115, 540116, 395228, 395229, 395230, 540020, 540002, 540017, 395225, 395226, 395227, 460999, 461006, 461007, 461008, 461009, 461003, 451460, 460995, 395217, 395218, 395219, 328204, 461002, 395182, 395183, 395184, 395185, 395186, 395096, 441546, 441547, 441548, 441549, 460994, 218367, 218368, 218369, 460988, 461015, 461016, 333054, 385268, 385269, 526789, 526787, 394142, 460794, 394143, 394144, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 253573, 11074, 139006, 139007, 253575, 253651, 253650, 253652, 253653, 173170, 173169, 173177, 173176, 173183, 173182, 173187, 173184, 173185, 173186, 44343, 450190, 363391, 69885, 406281, 479600, 66750, 173192, 669, 670, 671, 459716, 459717, 544970, 544971, 672, 459722, 441387, 665, 666, 459719, 459720, 459721, 351226, 459718, 694, 541444, 541448, 541449, 541450, 541447, 541438, 541439, 541440, 368365, 368360, 368359, 368358, 368370, 368369, 537327, 537328, 537329, 537330, 537331, 537332, 464317, 130887, 464316, 488391, 488390, 377894, 507752, 152194, 151662};
        expected = 60.52020736268028;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {254631, 125209, 466005, 466004, 466009, 466008, 121632, 335144, 261707, 314261, 261711, 261710, 335152, 285829, 285809, 466013, 466014, 381155, 64621, 350887, 64631, 64632, 64626, 64627, 381147, 381148, 489574, 489575, 489576, 489577, 489578, 489579, 489569, 489570, 489571, 207073, 376293, 376294, 376295, 376296, 461824, 150332, 150333, 134781, 346236, 346240, 376297, 461817, 350888, 59667, 206296, 206297, 190983, 24330, 24331, 24332, 6909, 6910, 376299, 376300, 394753, 394754, 280792, 280793, 459178, 459179, 459180, 459181, 459182, 276032, 276031, 272944, 272945, 272946, 272947, 272948, 490487, 490488, 394749, 394750, 6926, 6927, 6929, 505658, 505659, 490484, 490485, 490486, 198794, 4618, 4619, 4620, 4622, 397373, 4623, 443768, 397368, 397369, 397364, 397363, 459811, 1334, 447781, 286972, 376122, 452103, 281828, 716, 717, 718, 171461, 171460, 171450, 171453, 452097, 452101, 452098, 452100, 146442, 146445, 354696, 286974, 452094, 452092, 338159, 172365, 376350, 253482, 253481, 253480, 253479, 141421, 387962, 141422, 57033, 57032, 376358, 405659, 405661, 173137, 173135, 173138, 173140, 173145, 10058, 376361, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 392790, 5238, 5239, 5240, 392837, 326217, 458557, 458558, 498680, 458555, 458556, 465777, 465778, 392838, 392839, 498681, 498682, 498683, 498684, 498685, 498686, 498687, 409045, 498605, 467919, 498606, 229655, 229656, 281661, 397830, 397835, 397727, 397743, 397731, 397732, 397733, 397744, 397752, 397751, 397750, 397749, 397753, 397741, 397742, 397745, 397748, 397775, 397771, 397772, 397773, 397774, 397766};
        expected = 60.62128320687872;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {255587, 455698, 455697, 465211, 3448, 262290, 262288, 465026, 360158, 253384, 253385, 465061, 465062, 442688, 465252, 465237, 465221, 383407, 83105, 488883, 465034, 262286, 486504, 486505, 465036, 465038, 465037, 315414, 465124, 465125, 301840, 485840, 485839, 298749, 298747, 298748, 493851, 493850, 493849, 493848, 493847, 493852, 493853, 493845, 493844, 493843, 82937, 43534, 493846, 262135, 367938, 481742, 481743, 357307, 262136, 493857, 493856, 493855, 266851, 266850, 266849, 266848, 266847, 266846, 266845, 266844, 482422, 482389, 482380, 482388, 482418, 482414, 482415, 482416, 482387, 482412, 482390, 537057, 482408, 482409, 482410, 162724, 488079, 545823, 483989, 488081, 313169, 313168, 313167, 313166, 313165, 313164, 313163, 313162, 480298, 54375, 54374, 54373, 313173, 313172, 293779, 293778, 488078, 488077, 488076, 488075, 488074, 488073, 54368, 488072, 488071, 488070, 488069, 488068, 488067, 417508, 466459, 466460, 417545, 417548, 417501, 416340, 15851, 15852, 351944, 30858, 30859, 494315, 373440, 373441, 373442, 459049, 545194, 319674, 319675, 319676, 387908, 387895, 387896, 387897, 387909, 387910, 387911, 387912, 387893, 387894, 190656, 199149, 190655, 387888, 387884, 387883, 194865, 521827, 288786, 532826, 521830, 521831, 352046, 543495, 543496, 352053, 543497, 352045, 287011, 543498, 387994, 387995, 449307, 542269, 350084, 473850, 473851, 502724, 472255, 514146, 514147, 514145, 183479, 283383, 282348, 30212, 183477, 502738, 502739, 387120, 387119, 291134, 291133, 291132, 416342, 416341, 501351, 291127, 45042, 291129, 291128, 291131, 291130, 397208, 397207, 461509, 453503, 57511, 57512, 17088, 17089, 489559, 489560, 450223, 450224, 86408, 17091, 7637, 7638, 449511, 86407, 86406, 86405, 86404, 86403, 86402, 344989, 344988, 344987, 344986, 540659, 540660, 540651, 540661, 540669, 540677, 540670, 412821, 412820, 412819, 518675, 518674, 467230, 183472, 183473, 541680, 280566, 467235, 480095, 467238, 467246, 467247, 467248, 467249, 467250, 370468, 350821, 350471, 350470, 350469, 350468, 350467, 350466, 350465, 7633, 7632, 7634, 280563, 280564, 468318, 468265, 7636, 314317, 314315, 314316, 6521, 326543, 6519, 181070, 358783, 471062, 6505, 6506, 6507, 6508, 6509, 6510, 6511, 6512, 6513, 6514, 6515, 6516, 6517, 424911, 424912, 301520, 26237, 6501, 6502, 6503, 435842, 435843, 435844, 435845, 487089, 435817, 435818, 171475, 947, 435645, 435646, 435647, 435648, 268619, 338623, 268625, 284060, 284061, 283037, 284048, 283038, 283039, 283040, 283041, 264255, 264256, 264257, 539101, 539099, 539100, 168198, 168199, 168196, 264911, 380941, 380940, 338142, 1341, 284540, 284541, 284532, 284533, 450207, 338148, 338135, 354696, 286974, 452094, 452092, 338159, 172365, 376350, 253482, 253481, 253480, 253479, 141421, 387962, 141422, 57033, 57032, 376358, 405659, 405661, 173137, 173135, 173138, 173140, 173145, 10058, 376361, 376362, 257305, 257306, 393099, 393097, 459855, 253550, 253549, 253555, 253554, 459852, 459853, 1325, 1326, 1327, 1328, 1318, 1319, 1320, 1321, 416610, 416612, 416613, 416614, 416609, 416615, 416616, 416617, 526293, 526294, 526295, 416604, 526290, 416608, 416607, 416603, 416602, 416601, 416600, 416599, 416598, 416597, 660, 659, 658, 657, 656, 655, 654, 653, 652, 651, 650, 649, 429437, 429436, 429435, 429434, 429447, 429470, 429469, 429468, 429456, 429461};
        expected = 62.10597960322358;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {532940, 532941, 327939, 327940, 327941, 205394, 284681, 199249, 17149, 327931, 327932, 378048, 205426, 541159, 390156, 390157, 17146, 17147, 509609, 12227, 237986, 179474, 471316, 11945, 11944, 11943, 11942, 11941, 11940, 11939, 11938, 11937, 11936, 11935, 11934, 11933, 11932, 11931, 12352, 12353, 110069, 468779, 75120, 251101, 323181, 323180, 281767, 281766, 11963, 11964, 11965, 493568, 493569, 203453, 288145, 288144, 13120, 473927, 17349, 17350, 81771, 81772, 81773, 17342, 17343, 17344, 17345, 386224, 535339, 535340, 535341, 535342, 535343, 535344, 535345, 535346, 535347, 535348, 17346, 17347, 17348, 81779, 81780, 81781, 81782, 81783, 81784, 81785, 81786, 81787, 81788, 81789, 310456, 246510, 246509, 212987, 501403, 110410, 110409, 110403, 110404, 110405, 110406, 110407, 110408, 110402, 110401, 246511, 246512, 246513, 246514, 18676, 18677, 246515, 110499, 110500, 110501, 110502, 382287, 255573, 255574, 255575, 255576, 255577, 283923, 283924, 283925, 283926, 18678, 18679, 18680, 18681, 543856, 543857, 543858, 543859, 280272, 280273, 280274, 280275, 280276, 280277, 280278, 280279, 280280, 280281, 280282, 280283, 280284, 280285, 280286, 280287, 280288, 280289, 280290, 280291, 252678, 476075, 476866, 513517, 476867, 481758, 476073, 42913, 27517, 86412, 43219, 43212, 280646, 280647, 43209, 43210, 43211, 475756, 17244, 466633, 494191, 494192, 361889, 463611, 463612, 245737, 245738, 245739, 245740, 252776, 463614, 463615, 463617, 252777, 45042, 291127, 501351, 416341, 416342, 291132, 291133, 291134, 240272, 387118, 240271, 183478, 482510, 30212, 282348, 283383, 282346, 365688, 540398, 514145, 514147, 514146, 472255, 502725, 502726, 502727, 449308, 387993, 293014, 293015, 352050, 352051, 352049, 487043, 487042, 513369, 513371, 513370, 352047, 352048, 521832, 445046, 354149, 521826, 387887, 387885, 387882, 387886, 521885, 442779, 26869, 26870, 387916, 387915, 351950, 443532, 443533, 387902, 387905, 459051, 465178, 465179, 465180, 29564, 315411, 315412, 29430, 488064, 275616, 288312, 288313, 288309, 450350, 450351, 480362, 450352, 450353, 526367, 480363, 480353, 471014, 471015, 471016, 471017, 471018, 471019, 493639, 216704, 511612, 453502, 420685, 521162, 521163, 521164, 521159, 521152, 521153, 521151, 521154, 521157, 521158, 473145, 521165, 473139, 493281, 465325, 465326, 493272, 493256, 493257, 466095, 348332, 466085, 466083, 466100, 466096, 545942, 466104, 5160, 5161, 261220, 261221, 261222, 261223, 261224, 261225, 261226, 261227, 261228, 261229, 261230, 261231, 261232, 261233, 261234, 261235, 261236, 545497, 313828, 313829, 487841, 534588, 534387, 534231, 534232, 545495, 231993, 545496, 231994, 471799, 471800, 471794, 337497, 471803, 471812, 337498, 337499, 337500, 532719, 532720, 540840, 337496, 537078, 537077, 537076, 537075, 537074, 537073, 537072, 459366, 487840, 261252, 261251, 261250, 261249, 261248, 261247, 261246, 261245, 261244, 261243, 261242, 261241, 261240, 261239, 479301, 479300, 479299, 341389, 494454, 449331, 269433, 269432, 160200, 160199, 360152, 172822, 172823, 428520, 428523, 428521, 428522, 360128, 231020, 231021, 360121, 130201, 444268, 465253, 197392, 197391, 205755, 205756, 56188, 391881, 391879, 182772, 64139, 338996, 78903, 78901, 78899, 327230, 327231, 356083, 356081, 215523, 338994, 471972, 273848, 338999, 53877, 275377, 275381, 466766, 466767, 64129, 376037, 6446, 182768, 182769, 182761, 169289, 169290, 374703, 374704, 374705, 374706, 182850, 182849, 304438, 6447, 387821, 176635, 153657, 153658, 153659, 358519, 526682, 338146, 304444, 304443, 374702, 287595, 287594, 287593, 287598, 39411, 387819, 491288, 491289, 491290, 491287, 39403, 486048, 39404, 39405, 39406, 39407, 443591, 491291, 375827, 375828, 35599, 40108, 35581, 35582, 35583, 38756, 35574, 35575, 35570, 35571, 38825, 38868, 389577, 389576, 370463, 370464, 370465, 370466};
        expected = 63.27012148421986;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {180942, 181146, 181147, 180943, 180944, 180945, 180946, 180947, 180948, 180949, 180950, 180951, 180940, 479977, 441375, 441361, 441362, 441363, 441353, 23916, 114218, 23915, 66963, 164557, 164558, 164552, 66957, 66958, 66959, 66960, 66956, 406264, 8095, 338190, 338191, 338192, 152251, 152239, 152238, 529559, 535035, 451801, 529560, 338167, 535039, 126814, 451709, 535036, 535037, 535038, 470330, 470331, 507129, 470336, 514271, 514272, 377831, 377832, 435937, 417911, 417910, 417909, 417908, 44367, 44368, 377833, 377834, 44369, 44370, 44371, 44372, 417904, 417906, 44373, 44383, 106261, 106262, 441401, 441402, 441403, 522133, 522134, 522135, 441405, 441383, 44382, 440195, 440196, 440197, 440198, 440199, 378455, 464745, 378453, 438607, 438608, 438609, 438610, 438611, 438612, 438613, 438614, 438615, 378454, 494305, 18901, 496698, 20277, 496697, 438606, 481524, 20287, 481521, 450317, 450318, 18906, 378447, 378445, 378446, 167428, 167429, 167430, 167431, 167432, 167433, 167434, 18907, 18908, 267481, 267482, 267483, 267484, 267485, 267486, 18914, 18915, 18916, 18917, 378438, 378439, 378440, 378441, 378442, 378443, 464719, 541368, 541369, 541370, 393171, 465766, 465767, 393183, 378432, 378433, 378434, 378435, 378436, 378437, 464755, 464756, 464757, 464758, 20221, 20222, 20223, 20224, 20225, 20226, 20227, 464699, 464746, 107544, 107545, 20228, 456887, 212799, 456888, 456889, 456890, 456891, 456892, 212805, 212806, 20206, 541333, 516110, 20208, 377268, 377269, 377270, 377271, 377272, 377273, 377274, 377275, 377276, 377277, 377278, 377279, 377280, 377281, 377282, 377283, 20201, 541360, 541361, 20199, 20203, 20204, 456468, 456469, 456456, 456457, 456458, 456459, 456460, 456461, 456462, 456463, 456464, 456478, 456479, 456480, 456481, 456482, 456483, 456471, 456472, 456473, 456474, 456475, 456476, 456477, 456484, 456485, 456486, 456487, 456488, 545861, 456466, 456467, 473767, 456470, 538920, 538921, 538922, 212902, 456465, 321807, 456498, 541727, 456495, 468076, 436435, 436436, 436437, 436438, 436428, 436429, 436430, 436431, 436432, 436433, 436434, 436423, 436424, 436425, 456492, 456493, 474397, 474398, 474399, 545887, 545888, 481664, 481665, 542877, 542872, 542878, 83856, 354904, 354905, 354906, 354907, 354901, 456494, 21650, 545882, 545883, 545884, 545885, 545886, 445844, 456499, 456500, 456501, 456502, 456503, 456504, 456505, 445843, 69579, 69580, 69581, 69582, 545870, 545871, 545872, 288224, 288225, 474185, 290803, 456511, 456512, 448350, 389233, 456915, 456914, 456913, 456912, 456910, 456909, 405811, 405810, 405809, 405808, 405807, 405806, 405805, 405804, 405803, 405802, 405801, 405800, 405799, 405798, 405797, 405796, 405795, 456922, 456921, 405813, 405812, 456908, 456907, 456906, 456905, 456904, 456903, 456902, 466119, 466118, 466123, 466120, 466121, 466122, 339060, 522174, 195968, 195967, 195966, 497388, 497387, 497395, 21599, 325917, 325916, 325915, 325914, 325913, 325912, 325911, 325910, 325909, 325908, 325907, 325906, 325905, 325904, 325903, 325902, 325901, 325900, 253010, 253009, 253008, 253007, 253006, 253005, 253004, 253003, 253002, 21647, 285097, 132558, 29401, 540699, 540700, 540701, 540702, 540703, 546169, 546170, 546167, 546168, 458954, 252676, 252677, 480954, 480955, 480956, 480957, 480958, 480959, 494282, 494270, 494271, 494272, 494264, 494265, 29777, 29778, 29779, 494281, 126589, 491523, 521517, 257746, 257747, 257748, 521518, 521521, 521523, 521522, 521524, 450493, 289693, 151183, 36705, 36706, 471648, 514611, 151179, 514610, 471662, 219899, 471649, 437434, 451346, 494109, 444572, 471114, 471115, 500561, 500560, 282713, 494112, 482475, 482476, 482505, 482478, 482479, 482508, 482482, 482483, 183474, 482498, 482499, 482500, 482496, 482497, 514148, 269510, 269509, 183475, 30212, 482510, 296545, 282349, 282350, 183483, 502732, 502737, 502735, 44499, 44498, 296599, 296598, 296597, 296617, 23327, 46185, 46186, 46187, 46188, 82005, 503964, 502198, 502199, 491775, 367822, 367823, 484747, 511776, 520203, 597, 353845, 353846, 513919, 502195, 502196, 502197, 513920, 291769, 291770, 291771, 514966, 541888, 541889, 514964, 147801, 147802, 514965, 514967, 514968, 276704, 276705, 505898, 505896, 505899, 505897, 505894, 505895, 450470, 505901, 367978, 467037, 467040, 467039, 467038, 477141, 477140, 477142, 148549, 477144, 477146, 477143, 477145, 371024, 118990, 118989, 477147, 477150, 477152, 30349, 474228, 470149, 477153, 470146, 546046, 470147, 470148, 2455, 2456, 2457, 2458, 301878, 301879, 438292, 479160, 268172, 497385, 289900, 301854, 497384, 291605, 388235, 291606, 289899, 525643, 497349, 497347, 497348, 477131, 477126, 477127, 477128, 477129, 477130, 296164, 477132, 31741, 502332, 502333, 160026, 160025, 502334, 160029, 502328, 502327, 502329, 100448, 100447, 100446, 100445, 160056, 160055, 160054, 160053, 160052, 160051, 160050, 340753, 340752, 340751, 340750, 340749, 169374};
        expected = 64.78285059828158;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {505581, 480168, 480167, 480166, 480165, 480164, 325750, 325751, 325752, 327545, 400401, 545479, 400411, 400412, 400413, 545490, 474886, 400186, 400187, 400189, 534872, 400185, 540139, 540137, 540138, 400181, 542322, 4824, 4825, 4826, 4827, 545714, 545715, 403993, 395223, 395224, 395216, 395217, 395218, 395219, 328204, 461002, 395182, 395183, 395184, 395185, 395186, 395096, 441546, 441547, 441548, 441549, 460994, 218367, 218368, 218369, 460988, 461015, 461016, 333054, 385268, 385269, 526789, 526787, 394142, 460794, 394143, 394144, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 253573, 11074, 139006, 139007, 253575, 253651, 253650, 253652, 253653, 173170, 173169, 173177, 173176, 173183, 173182, 173187, 173184, 173185, 173186, 8091, 8092, 160463, 160464, 455860, 338185, 466253, 451802, 152240, 152241, 152248, 152249, 152250, 529571, 529572, 338188, 487905, 451811, 451810, 12843, 12844, 451814, 79147, 451826, 79142, 79143, 153020, 196940, 524747, 79139, 64000, 519372, 519371, 519370, 519369, 128939, 352394, 352393, 352392, 352391, 352390, 352389, 352388, 352387, 352386, 352385, 352384, 461119, 461118, 461117, 461116, 533380, 533379, 461114, 538669, 538668, 434609, 434608, 434607, 352383, 352382, 79138, 79137, 79136, 79135, 79134, 79133, 79132, 79131, 79130, 79129, 79128, 85641, 75184, 75185, 75186, 75183, 75182};
        expected = 65.06012330153115;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {259950, 259951, 259952, 259953, 259954, 259955, 383118, 383106, 478412, 478413, 192289, 192288, 192287, 99150, 99149, 99148, 99147, 99146, 99145, 99144, 99143, 99142, 99141, 99140, 99139, 99138, 99137, 99136, 192639, 192638, 192637, 500046, 500045, 500044, 98783, 98784, 98785, 98786, 98787, 98788, 191853, 191854, 191855, 191856, 191857, 98823, 98824, 192054, 192205, 192206, 192207, 192208, 192209, 93056, 8399, 8400, 117275, 381388, 381389, 381381, 381382, 381383, 381384, 381385, 381386, 381387, 465797, 81492, 8403, 8408, 8407, 93060, 93059, 93058, 42601, 42602, 458399, 458400, 458401, 458402, 458403, 458404, 458405, 377843, 377844, 377837, 377838, 377839, 377840, 377841, 377842, 476439, 476440, 476441, 42592, 42593, 42594, 42595, 42596, 42597, 42598, 476436, 476437, 476438, 40490, 40491, 40492, 40493, 40494, 40495, 476463, 476464, 26391, 26392, 148995, 406274, 173186, 44343, 450190, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 16898, 25368, 78557, 523924, 78555, 448578, 10554, 10555, 324814, 378838, 378842, 378843, 378844, 378845, 378846, 378847, 75796, 378876, 10552, 10553, 249761, 249760, 360659, 360656, 360657, 360658, 151818, 151816, 232568, 232569, 232570, 365374, 365379, 142185, 142186, 387796, 387786, 387787, 249807, 249808, 249809, 378486, 534831, 357696, 357697, 255901, 46979, 46980, 46972, 46973, 23843, 477862, 477863, 477864, 477865, 477866, 477867, 226612, 534953, 435212, 360165, 477869, 23848, 23849, 23850, 534952, 226608, 226609, 226601, 226602, 226603, 226610, 110682, 110681, 110680, 23854, 23853, 23852, 23855, 23856, 23857, 477874, 535735, 535731, 23837, 23839, 407416, 407417, 407418, 23840, 23841, 346592, 346593, 357767, 357768, 357769, 234458, 234459, 234460, 357770, 369940, 23842, 443460, 443459, 357771, 357772, 357773, 357774, 357775, 357780, 357781, 357782, 357783, 357784, 357785, 357779, 23826, 23827, 23828, 23829, 58762, 357804, 357805};
        expected = 66.26661351994996;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {400734, 334783, 537765, 537764, 250162, 395250, 540107, 540106, 540105, 540104, 395247, 395246, 395249, 9467, 540021, 540014, 540113, 540114, 540115, 540116, 395228, 395229, 395230, 540020, 540002, 540017, 395225, 395226, 395227, 460999, 461006, 461007, 461008, 461009, 461003, 451460, 460995, 395217, 395218, 395219, 328204, 461002, 395182, 395183, 395184, 395185, 395186, 395096, 441546, 441547, 441548, 441549, 460994, 218367, 218368, 218369, 460988, 461015, 461016, 333054, 385268, 385269, 526789, 526787, 394142, 460794, 394143, 394144, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 253573, 11074, 139006, 139007, 253575, 253651, 253650, 253652, 253653, 173170, 173169, 173177, 173176, 173183, 173182, 173187, 173184, 173185, 173186, 44343, 450190, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 16898, 219580, 448574, 143953, 143955, 229270, 229271, 448580, 448581, 448582, 448553, 448557, 143995, 143991, 143992, 442892, 448551, 448550, 143998, 143999, 144003, 144002, 21169, 448480, 142862, 448473, 493990, 233889, 233890, 233891, 233892, 233893, 532697, 359691, 359692, 532716, 52236, 52237, 52238, 52230, 52231, 149662, 149663, 376910, 376911, 376912, 376913, 376914, 376915, 52245, 52246, 52247, 149664, 52262, 52263, 52264, 284355, 284356, 284357, 284358, 376924, 383921, 383920, 52229, 52256, 52253, 511326, 511329, 511328, 511327, 359877, 307883, 307882, 307881, 307887, 307886, 307885, 307884, 511330, 511331, 308575, 308574, 308576, 52252, 52251, 70603, 52269, 52270, 52271, 72942, 146559, 146560, 377546, 377547, 172854, 172855, 383914, 383912, 383913, 339592, 339593, 339594, 339595, 339596, 339597, 339598, 391261, 171618, 171619, 171620, 171621, 72997, 345014, 429513, 429514, 472267, 368618, 175595, 537392, 537401, 537402, 537403, 36095, 338779, 237170, 176033, 221652, 236004, 36091, 36092, 36108, 36109, 36110, 126314};
        expected = 72.98260706238533;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {468462, 468461, 48986, 48983, 48987, 48981, 514597, 514596, 514595, 514594, 514593, 514592, 514591, 514590, 514589, 323092, 323091, 369308, 369307, 369306, 369305, 369311, 369310, 369309, 389527, 389526, 389525, 389524, 44196, 44195, 12730, 12731, 12724, 58386, 58387, 389541, 389542, 389543, 389559, 389560, 389551, 389552, 389553, 389522, 389523, 389533, 389558, 389538, 59111, 59112, 102086, 102087, 80670, 91460, 91461, 80669, 389521, 305501, 12721, 305493, 58389, 389532, 12706, 13258, 234687, 58390, 58007, 58010, 58011, 387613, 387614, 166116, 166117, 166086, 166087, 166088, 387608, 387609, 387610, 537694, 537695, 537696, 387615, 387616, 387617, 11102, 11103, 11097, 375989, 375990, 375991, 375992, 487647, 375743, 375744, 376100, 156029, 375741, 375728, 375729, 375730, 18743, 542183, 57581, 185390, 185389, 57587, 57586, 57582, 1917, 280991, 280990, 542177, 143813, 143812, 435858, 453406, 436658, 292050, 453405, 159966, 542186, 34782, 143808, 542188, 143806, 527816, 527817, 487760, 238079, 378351, 479019, 10200, 1102, 1103, 465135, 465136, 479800, 3734, 479793, 1087, 1088, 358240, 358241, 358242, 358243, 358244, 358245, 94860, 375864, 375865, 480898, 480891, 1007, 1008, 301788, 301789, 375862, 375863, 34162, 34157, 34158, 34159, 34160, 34161, 351636, 351637, 351633, 351622, 108974, 351628, 351629, 351630, 351631, 351632, 108975, 108976, 108977, 108978, 108979, 506390, 506391, 504227, 160352, 511913, 511914, 511915, 160353, 160354, 300347, 300348, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 249360, 300350, 364085, 364086, 363472, 480885, 480884, 480882, 40054, 363469, 376012, 40058, 160307, 523514, 523511, 416801, 302399, 302400, 302401, 302402, 538476, 538477, 538478, 503859, 503852, 162510, 162511, 300548, 300549, 40045, 40044, 300541, 300542, 300543, 300544, 300545, 300546, 512350, 512351, 512352, 517312, 517313, 302390, 302391, 302392, 302383, 302384, 302385, 302386, 488046, 339782, 339783, 476619, 476610, 488048, 488047, 352216, 81426, 352197, 529048, 529049, 529050, 529051, 482372, 376204, 376203, 376202, 376201, 529046, 529045, 485108, 485109, 529044, 485110, 529043, 71, 70, 284982, 477322, 477321, 284981, 284980, 477320, 477319, 297542, 297541, 297540, 515177, 515180, 515178, 529040, 81423, 515175, 512418, 512419, 512420, 512421, 512422, 285119, 285116, 285117, 285118, 81416, 81417, 512417, 512415, 485629, 485630, 485631, 485632, 485633, 485634, 485635, 485636, 485637, 485638, 210569, 210568, 295920, 378418, 518458, 295921, 295907, 301525, 301526, 301527, 418122, 518453, 518454, 489897, 489898, 418119, 418120, 418121, 110484, 274327, 450893, 18436, 18435, 18434, 514029, 514030, 514031, 514032, 416372, 416373, 416374, 416375, 416350, 416351, 416352, 416353, 416354, 416355, 416356, 416357, 416358, 416359, 416360, 416361, 416362, 416363, 416364, 416365, 416366, 416367, 416368, 416369, 416370, 416371, 303036, 418210, 418211, 274616, 274617, 274618, 418223, 274614, 274613, 389628, 389630, 389629, 543167, 543166, 389627, 389626, 389625, 389624, 389623, 391047, 391046, 391045, 391044, 391043, 391042, 391041, 391040, 438732, 438731, 438730, 438729, 438728, 438727, 438726, 438725, 438724, 438723, 438722, 438721, 438720, 391049, 18654, 51884, 51883, 51882, 363488, 395483, 395484, 395482, 363495, 464853, 363500, 363501, 395485, 395486, 395487, 395488, 395489, 395490, 395491, 395492, 363503, 509683, 509684, 509685, 509686, 509687, 363511, 260828, 260827, 260826, 260825, 260824, 260823, 68771, 68770, 68769, 68768, 18655, 246185, 246186, 246187, 246188, 246189, 246190, 246191, 246192, 246193, 246194, 246195, 246196, 246197, 246198, 246199, 246200, 246201, 246202, 246203, 246204, 498340, 498341, 498336, 498337, 498338, 498339, 275795, 275796, 364037, 364038, 498334, 498335, 519616, 417857, 302978, 269447, 474740, 269448, 474146, 417863, 417864, 417865, 417866, 206359, 206360, 206355, 206356, 206357, 206358, 474145, 417870, 417871, 474149, 474150, 269446, 206352, 444893, 175931, 109258, 109259, 170467, 170468};
        expected = 74.81269649430858;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {215881, 48908, 76885, 76886, 76887, 76888, 76889, 76890, 76891, 76892, 76893, 76894, 18604, 18605, 18606, 135683, 135684, 135685, 135686, 135687, 135688, 135689, 135690, 135691, 135692, 143406, 143403, 143404, 138837, 138838, 138839, 478752, 458686, 472415, 472416, 472417, 472402, 472398, 472399, 472400, 468838, 478747, 96237, 96236, 96235, 96242, 96234, 478749, 478748, 96227, 96228, 96229, 96225, 535448, 162699, 162700, 162701, 96220, 451828, 12846, 451823, 451820, 451821, 451822, 531316, 531317, 406263, 406264, 8095, 338190, 338191, 338192, 152251, 152239, 152238, 529559, 535035, 451801, 529560, 406278, 535042, 8094, 160459, 160460, 377830, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 1923, 474067, 474068, 374710, 374711, 374712, 374713, 363662, 363664, 38421, 387964, 387974, 387973, 387971, 1929, 412093, 412095, 387969, 246433, 129531, 129532, 304667, 178653, 505418, 505419, 304640, 304641, 187517, 178650, 453427, 270401, 270399, 144056, 144059, 270403, 270402, 451693, 1934, 512298, 376701, 493794, 259208, 259209, 75950, 543940, 543941, 543942, 543943, 1935, 477083, 464451, 464452, 173006, 142701, 142702, 142703, 153552, 477076, 477080, 38334, 427032, 427033, 427034, 427027, 427028, 427025, 530160, 427029, 38268, 219729, 153561, 153562, 512303, 512304, 512305, 38635, 263084, 357663, 181728, 181729, 303661, 303662, 303659, 303660, 453426, 164406, 164404, 453420, 453421, 164400, 164399, 1933, 304259, 304258, 176642, 176640, 176641, 28047, 453417, 453414, 453411, 358516, 358517, 358518, 176634, 176633, 387818, 182865, 182866, 182851, 6442, 6443, 32140, 32141, 32142, 32146, 182822, 182823, 32139, 374705, 33364, 33366, 33367, 182859, 182860, 182861, 20564, 20563, 506053, 506052, 506051, 506050, 506049, 462476, 462475, 403580, 403581, 281291, 281290, 281289, 281288, 281287, 281286, 281285, 281284, 281283, 281282, 281281, 515117, 515116, 163482, 163504, 163505};
        expected = 76.4841277744886;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {540686, 380373, 380372, 380371, 380370, 540697, 540698, 540693, 163501, 540682, 540683, 540684, 100647, 14172, 540881, 14168, 100648, 491234, 540692, 109642, 261530, 382695, 380419, 380417, 5601, 461141, 339009, 339010, 339011, 339012, 247329, 247330, 330548, 291407, 410870, 410871, 7622, 7623, 65943, 408851, 5507, 380961, 380960, 408894, 408895, 272882, 436652, 275751, 275752, 380955, 380958, 451246, 451251, 65877, 65876, 436656, 5505, 5506, 5504, 380942, 380951, 380954, 380946, 3804, 3805, 380953, 380945, 336931, 336932, 436641, 291946, 291947, 291948, 65944, 451247, 1340, 450212, 338144, 284903, 284904, 338140, 715, 171452, 171451, 171462, 171463, 171464, 171465, 281826, 281827, 476019, 452102, 286971, 206723, 422902, 459899, 459900, 459901, 450188, 218943, 218944, 218945, 264838, 264842, 264843, 264850, 264849, 459896, 459893, 382302, 382303, 382296, 382300, 382301, 191213, 191214, 191215, 191216, 339887, 184814, 184813, 159970, 251594, 251595, 251598, 251597, 159971, 367668, 184811, 452206, 449, 355638, 159740, 159741, 254155, 159973, 159974, 436666, 143795, 143796, 438796, 437300, 387773, 34740, 143790, 387761, 387755, 387763, 387762, 141758, 238080, 542185, 143809, 143810, 542187, 143811, 1585, 292051, 453407, 435859, 143814, 542176, 143815, 280988, 280989, 57584, 185387, 57585, 57583, 185388, 185391, 542184, 57468, 57476, 387622, 57475, 387621, 57474, 57473, 356055, 356056, 57469, 53749, 542180, 327423, 57463, 57462, 57461, 542179, 57460, 387815, 57454, 57453, 542182, 53751, 1492, 1493, 304251, 304252, 304250, 304240, 304242, 304243, 304244, 357661, 357662, 176643, 219731, 304260, 304261, 357660, 209854, 209852, 453423, 22816, 22817, 378354, 22825, 337095, 337096, 337097, 337098, 337099, 337100, 337101, 337102, 337103, 337104, 337105, 337106, 337107, 337108, 383232, 383233, 383234, 508305, 508306, 508307, 337113, 426513, 426514, 426515, 508304, 366623, 366624, 366625, 366626, 366627, 366628, 366629, 366630, 366631, 366632, 366633, 366634, 366635, 366636, 366614, 366615, 366608, 366610, 366611, 366612, 366613, 337111, 337112, 323875, 323876, 294318, 68663, 353413, 338671, 338670, 338669, 338668};
        expected = 84.47240276273556;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {246148, 246149, 246150, 148337, 148338, 148339, 148340, 148341, 148342, 148343, 299966, 299967, 307189, 307190, 307191, 307192, 307193, 307194, 150784, 303363, 150782, 303352, 63158, 63157, 63156, 63155, 303353, 388072, 388077, 63230, 63231, 63232, 388084, 388058, 388057, 388056, 388078, 388079, 63229, 63227, 63228, 338193, 63222, 487903, 85737, 85738, 338206, 222468, 339762, 339757, 339758, 339759, 339760, 339761, 376881, 376882, 376883, 460815, 460816, 318614, 318615, 460812, 460813, 376892, 12845, 12846, 451823, 451820, 451821, 451822, 531316, 531317, 406263, 406264, 8095, 338190, 338191, 338192, 152251, 152239, 152238, 529559, 535035, 451801, 529560, 406278, 535042, 535040, 535041, 11072, 11073, 520550, 173189, 173188, 173181, 173180, 173179, 173178, 173168, 173171, 4143, 4144, 4145, 253655, 253654, 253648, 253649, 139005, 139004, 253570, 253571, 453815, 453818, 253569, 173159, 388593, 388590, 388591, 10062, 376368, 173154, 173155, 71746, 152802, 152801, 426564, 1317, 475848, 517704, 376366, 376363, 376364, 376365, 257307, 257308, 376360, 173147, 173146, 173141, 173139, 173136, 140358, 405658, 405660, 487746, 376359, 475849, 514228, 57031, 498797, 407469, 376354, 452090, 253483, 253484, 253485, 253486, 376351, 376352, 172366, 452091, 338164, 401039, 286981, 452095, 354695, 146446, 146443, 146444, 284905, 284906, 338140, 715, 171452, 171451, 171462, 171463, 171464, 171465, 281826, 281827, 476019, 452102, 286971, 206723, 422902, 459899, 459900, 459901, 450188, 218943, 218944, 218945, 264838, 264842, 264843, 264850, 264849, 459896, 459893, 382302, 382303, 382296, 382300, 382301, 191213, 191214, 191215, 191216, 339887, 184814, 184813, 159970, 251594, 251595, 251598, 251597, 159971, 367668, 184811, 452206, 449, 355638, 159740, 159741, 254155, 159973, 9522, 9523, 121066, 478087, 478093, 109702, 388551, 388552, 388548, 388553, 388544, 388545, 388546, 356437, 388542, 11255, 478044, 478053, 478054, 478059, 478102, 7514, 7515, 7516, 7517, 272865, 11260, 11261, 11262, 11263, 11264, 4051, 272864, 272862, 272863, 387877, 387871, 387872, 397150, 397147, 460154, 418038, 397131, 506657, 506777, 506663, 397132, 397133, 397137, 397136, 397135, 397134, 396876, 506660, 506659, 159856, 272853, 506425, 506405, 88120, 88126, 88127, 88145, 506420, 272856, 88146, 23641, 272854, 506408, 26416, 4670, 397145, 397143, 64252, 64251, 506422, 3858, 506423, 386315, 178686, 178687, 178688, 178689, 178683, 178679, 178680, 178681, 396893, 396894, 396895, 396896, 396897, 10254, 10244, 386309, 386310, 386311, 64267, 64264, 64271, 366034, 51027, 147066, 147067, 147068, 147069, 147070, 2405, 2406, 2407, 13989, 531265, 531266, 280065, 10797, 10798, 10799, 319079, 319080, 319081, 10795, 319072, 289332, 289333, 22203, 61086, 372775};
        expected = 94.70361526493285;
        actual = compute_path_travel_time(path);
        CHECK(relative_error(expected, actual) < 0.001);
        
    } //compute_path_travel_time

} //path_cost_public

